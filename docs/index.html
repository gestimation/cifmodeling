<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>cifmodeling • cifmodeling</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="cifmodeling">
<meta name="description" content="A compact and unified toolkit for Kaplan–Meier/Aalen–Johansen curves, visualization, and direct polytomous regression for survival and competing risks data.">
<meta property="og:description" content="A compact and unified toolkit for Kaplan–Meier/Aalen–Johansen curves, visualization, and direct polytomous regression for survival and competing risks data.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">cifmodeling</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.6.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/01_overview.html">Overview</a></li>
    <li><a class="dropdown-item" href="articles/02_functions.html">Main functions</a></li>
    <li><a class="dropdown-item" href="articles/03_polyreg.html">Direct polytomous modeling of CIFs</a></li>
    <li><a class="dropdown-item" href="articles/04_examples.html">Examples</a></li>
    <li><a class="dropdown-item" href="articles/05_information.html">Additional information</a></li>
    <li><a class="dropdown-item" href="articles/06_arguments.html">Full lists of arguments</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/gestimation/cifmodeling"><span class="fa fa-github"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="visualization-and-modeling-of-competing-risks-in-r--cifmodeling">Visualization and Modeling of Competing Risks in R — cifmodeling<a class="anchor" aria-label="anchor" href="#visualization-and-modeling-of-competing-risks-in-r--cifmodeling"></a>
</h1></div>
<!-- badges: start -->
<!-- badges: end -->
<div class="section level2">
<h2 id="quick-start">Quick start<a class="anchor" aria-label="anchor" href="#quick-start"></a>
</h2>
<p>This package is a compact and unified toolkit for Kaplan–Meier/Aalen–Johansen curves, visualization, and direct polytomous regression of cumulative incidence functions in R.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/gestimation/cifmodeling" class="external-link">cifmodeling</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">diabetes.complications</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/cifplot.html">cifplot</a></span><span class="op">(</span><span class="fu"><a href="reference/Event.html">Event</a></span><span class="op">(</span><span class="va">t</span>,<span class="va">epsilon</span><span class="op">)</span> <span class="op">~</span> <span class="va">fruitq</span>, data<span class="op">=</span><span class="va">diabetes.complications</span>, </span>
<span>        outcome.type<span class="op">=</span><span class="st">"COMPETING-RISK"</span>, printEachEvent<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-example0-1-1.png" width="100%"></p>
<p>This is an example code snippet applying <code><a href="reference/cifplot.html">cifplot()</a></code> to visualize Aalen–Johansen cumulative incidence functions (CIFs). In competing risks data, censoring is often coded as 0, events of interest as 1, and competing risks as 2. The variable <code>epsilon</code> in <code>diabetes.complications</code> data frame represents the occurrence of competing risks according to this coding scheme. By setting <code>printEachEvent=TRUE</code>, the CIF curve for diabetic retinopathy (<code>epsilon=1</code>) is output on the left and macrovascular complications (<code>epsilon=2</code>) on the right.</p>
</div>
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>In clinical and epidemiological research, analysts often need to handle censoring, competing risks, and intercurrent events (e.g., treatment switching), but existing R packages typically separate these tasks into different interfaces. <code>cifmodeling</code> provides a <strong>unified, publication-ready toolkit</strong> that integrates description of survival and CIF curves, regression modeling, and visualization for survival and competing risks data. It covers both nonparametric estimation and regression modeling of CIFs, centered around three tightly connected functions.</p>
<ul>
<li><p><code><a href="reference/cifplot.html">cifplot()</a></code> typically generates a survival or cumulative incidence curve with marks that represent censoring, competing risks and intercurrent events. Multiple variance estimators and confidence interval methods are supported. Visualization relies on <code>ggsurvfit/ggplot2</code>.</p></li>
<li><p><code><a href="reference/cifpanel.html">cifpanel()</a></code> generates a multi-panel figure for survival/CIF curves, arranged either in a grid layout or as an inset overlay.</p></li>
<li><p><code><a href="reference/polyreg.html">polyreg()</a></code> fits coherent regression models of CIFs based on polytomous log odds products and the stratified IPCW estimator. This function is particularly well-suited for causal inference in terms of typical effect measures, namely risk ratios, odds ratios, and subdistribution hazard ratios, with a competing risks, survival, or binary outcome.</p></li>
</ul>
<p>These functions adopt a formula + data syntax, return tidy, publication-ready outputs, and integrate seamlessly with <code>ggsurvfit</code> and <code>modelsummary</code> for visualization.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>The package is implemented in R and relies on <code>Rcpp</code>, <code>nleqslv</code> and <code>boot</code> for the numerical back-end. The examples in this README also use <code>ggplot2</code>, <code>ggsurvfit</code>, <code>patchwork</code> and <code>modelsummary</code> for tabulation and plotting. Install the core package and these companion packages with:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"Rcpp"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"nleqslv"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"boot"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"ggplot2"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"ggsurvfit"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"patchwork"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"modelsummary"</span><span class="op">)</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"gestimation/cifmodeling"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="interoperability">Interoperability<a class="anchor" aria-label="anchor" href="#interoperability"></a>
</h2>
<p>There are several excellent R packages for survival and competing-risk analysis. The survival package provides the canonical API for time-to-event data (e.g., <code>survival</code> and <code>mets</code>). In combination with <code>ggsurvfit</code>, you can produce publication-ready survival plots. For cumulative incidence (CIF) plots, integration in the general ecosystem is not as streamlined; <code>cifmodeling</code> fills this gap by offering <code><a href="reference/cifplot.html">cifplot()</a></code> for survival/CIF plots and multi-panel figures via a single, unified interface.</p>
<p>If you need fine-grained plot customization, compute the estimator and keep a survfit-compatible object with <code><a href="reference/cifcurve.html">cifcurve()</a></code> (or supply your own survfit object) and then style it using <code>ggsurvfit/ggplot2</code> layers. In other words, use <code><a href="reference/cifcurve.html">cifcurve()</a></code> for estimation, <code>cifplot()/cifpanel()</code> for quick high-quality figures, and fall back to the <code>ggplot</code> ecosystem when you want full artistic control.</p>
<p>For interval estimation, <code><a href="reference/cifcurve.html">cifcurve()</a></code> mirrors the confidence-interval options of <code><a href="https://rdrr.io/pkg/survival/man/survfit.html" class="external-link">survival::survfit()</a></code> for survival curves and adds <code>delta</code> and <code>aalen</code> options for CIFs. The defaults in <code>cifmodeling</code> are chosen from external and internal simulation evidence; they should be sensible for most applications, while still allowing experts to override them when needed.</p>
<p><code>mets</code> package is a more specialized toolkit that provides advanced statistical methods for competing risk analysis. <code><a href="reference/polyreg.html">cifmodeling::polyreg()</a></code> focuses on coherent modeling of all CIFs simultaneously using polytomous log odds products to estimate RR/OR/SHR at user-specified times; this coherence can come with longer runtimes on large problems. If you prefer fitting separate regression models for each competing event or need Fine–Gray specifically, <code><a href="https://kkholst.github.io/mets/reference/cifreg.html" class="external-link">mets::cifreg()</a></code> (and <code><a href="https://kkholst.github.io/mets/reference/binreg.html" class="external-link">mets::binreg()</a></code> for RR and OR estimation) are excellent choices.</p>
</div>
<div class="section level2">
<h2 id="quality-control">Quality control<a class="anchor" aria-label="anchor" href="#quality-control"></a>
</h2>
<p><code>cifmodeling</code> includes an extensive test suite built with <strong>testthat</strong>, ensuring the numerical accuracy and graphical consistency of all core functions (<code>cifcurve</code>, <code>cifplot</code>, <code>cifpanel</code>, and <code>polyreg</code>). The package is continuously tested on GitHub Actions (Windows, macOS, Linux) to maintain reproducibility and CRAN-level compliance.</p>
</div>
<div class="section level2">
<h2 id="main-functions">Main functions<a class="anchor" aria-label="anchor" href="#main-functions"></a>
</h2>
<div class="section level3">
<h3 id="cifplot">cifplot()<a class="anchor" aria-label="anchor" href="#cifplot"></a>
</h3>
<p>This function produces the <strong>Kaplan–Meier survival</strong> or <strong>Aalen–Johansen cumulative incidence</strong> curve from a unified formula + data interface. It auto-labels axes based on <code>outcome.type</code> and <code>type.y</code> (<code>"risk"</code> for 1-survival or CIF), can add censoring/competing-risk/intercurrent-event marks, and returns a regular ggplot object (compatible with + and %+%). You may also pass a survfit-compatible object directly.</p>
<p><strong>Typical use cases</strong></p>
<ul>
<li>Draw one survival/CIF curve set by exposure groups (e.g., treatment vs control).</li>
<li>Call <code><a href="reference/cifpanel.html">cifpanel()</a></code> with a simplified code to create a panel displaying plots of multiple stratified survival/CIF curves or CIF curves for each event type.</li>
<li>Add confidence intervals and censor/competing-risk/intercurrent-event marks.</li>
<li>Add a risk table to display the number at risk or the estimated survival probabilities or CIFs and 95% confidence intervals at each point in time.</li>
</ul>
<p><strong>Key arguments shared with cifcurve()</strong></p>
<ul>
<li>
<strong>Outcome type and estimator</strong>
<ul>
<li>
<code>formula</code> A model formula specifying the time-to-event outcome on the left-hand side (<code>Event(time, status)</code> or <code>Surv(time, status)</code>) and, optionally, a stratification variable on the right-hand side.</li>
<li>
<code>outcome.type = "SURVIVAL"</code> → Kaplan–Meier estimator</li>
<li>
<code>outcome.type = "COMPETING-RISK"</code> → Aalen–Johansen estimator</li>
</ul>
</li>
<li>
<strong>Confidence intervals</strong>
<ul>
<li>
<code>conf.int</code> sets the two-sided level (default 0.95)<br>
</li>
<li>
<code>conf.type</code> chooses the transformation (<code>"arcsine-square root"</code>, <code>"plain"</code>, <code>"log"</code>, <code>"log-log"</code>, <code>"logit"</code>, or <code>"none"</code>)</li>
<li>
<code>error</code> chooses the estimator for standard error (<code>"greenwood"</code> or <code>"tsiatis"</code> for survival curves and <code>"delta"</code> or <code>"aalen"</code> for CIFs)</li>
</ul>
</li>
</ul>
<p><strong>Key arguments for cifplot()</strong></p>
<ul>
<li>
<strong>Data visualization</strong>
<ul>
<li>
<code>addConfidenceInterval</code> adds confidence intervals on the ggplot2-based plot</li>
<li>
<code>addCompetingRiskMark</code> and <code>addIntercurrentEventMark</code> add symbols to describe competing risks or intercurrent events in addition to conventional censoring marks with <code>addCensorMark</code>
</li>
<li>
<code>addRiskTable</code> adds numbers at risk</li>
<li>
<code>addEstimateTable</code> adds estimates and 95% confidence interval</li>
<li>
<code>addQuantileLine</code> adds a line that represents median or quantile</li>
</ul>
</li>
<li>
<strong>Plot customization</strong>
<ul>
<li>
<code>type.y</code> chooses y-axis (<code>"surv"</code> for survival and <code>"risk"</code> for 1-survival or CIF)</li>
<li>
<code>limits.x</code>, <code>limits.y</code>, <code>breaks.x</code>, <code>breaks.y</code> numeric vectors for axis control</li>
<li>
<code>style</code> specifies the appearance of plot (<code>"CLASSIC"</code>, <code>"BOLD"</code>, <code>"FRAMED"</code>, <code>"GRID"</code>, <code>"GRAY"</code> or <code>"GGSURVFIT"</code>)</li>
</ul>
</li>
<li>
<strong>Panel display</strong>
<ul>
<li>
<code>printEachVar</code> produces multiple survival/CIF curves per stratification variable specified in the formula</li>
<li>
<code>printEachEvent</code> produces CIF curves for each event type</li>
<li>
<code>printCensoring</code> produces KM-type curves for (event, censor) and (censor, event) so that censoring patterns can be inspected</li>
<li>
<code>panel.mode</code> uses automatic panel mode</li>
</ul>
</li>
</ul>
<p><strong>Return</strong></p>
<ul>
<li>A <strong>ggplot</strong> object.</li>
</ul>
<p><strong>Under the hood: cifcurve()</strong></p>
<p><code><a href="reference/cifplot.html">cifplot()</a></code> is a streamlined, opinionated wrapper around <code><a href="reference/cifcurve.html">cifcurve()</a></code>, which calculates the Kaplan–Meier estimator and the Aalen–Johansen estimator. <code><a href="reference/cifcurve.html">cifcurve()</a></code> returns a survfit-compatible object, enabling an independent use of standard methods such as:</p>
<ul>
<li>
<code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> — time-by-time estimates with standard errors and confidence intervals</li>
<li>
<code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> — base R stepwise survival/CIF curves</li>
<li>
<code><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean()</a></code> — restricted mean survival estimates with confidence intervals</li>
<li>
<code><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile()</a></code> — quantile estimates with confidence intervals</li>
</ul>
<p>Furthermore, the cifmodeling package provides a workflow for a <strong>ggplot2-based visualization</strong> based on the survfit-compatible objects by passing them to <code><a href="reference/cifplot.html">cifplot()</a></code> and <code>cifpanel</code>.</p>
</div>
<div class="section level3">
<h3 id="cifpanel">cifpanel()<a class="anchor" aria-label="anchor" href="#cifpanel"></a>
</h3>
<p><code><a href="reference/cifpanel.html">cifpanel()</a></code> arranges multiple <code>cifplot()/cifcurve()</code> results into a unified grid layout with consistent scales, shared legend, and synchronized themes. It is ideal for visual comparison across outcomes, time scales, or strata. The inset feature also allows you to display another plot within a plot.</p>
<p><strong>Typical use cases</strong> - Compare CIF (event 1) vs CIF (event 2) in a 1×2 layout.</p>
<ul>
<li><p>Compare survival/CIF curves across strata with a shared legend and matched axes.</p></li>
<li><p>Display a plot with an enlarged y-axis within a plot scaled from 0 to 100%.</p></li>
</ul>
<p><strong>Key arguments</strong></p>
<ul>
<li>
<code>formula</code> or <code>formulas</code> — one formula or a list of formulas; each entry creates a panel.</li>
<li>
<code>data</code>, <code>outcome.type</code>, <code>code.events</code>, <code>type.y</code> — recycled across panels unless a list is supplied for per-panel control.</li>
<li>
<code>rows.columns.panel</code> — selects grid layout by c(rows, cols).</li>
<li>
<code>inset.panel</code> — selects inset layout.</li>
<li>
<code>title.panel</code>, <code>subtitle.panel</code>, <code>caption.panel</code>, <code>title.plot</code> — overall titles and captions.</li>
<li>
<code>tag.panel</code> — panel tag style (e.g., “A”, “a”, “1”).</li>
<li>
<code>label.x</code>, <code>label.y</code>, <code>limits.x</code>, <code>limits.y</code>, <code>breaks.x</code>, <code>breaks.y</code> — shared axis control unless a list is supplied for per-panel control.</li>
</ul>
<p><strong>Return</strong></p>
<ul>
<li>A <strong>patchwork</strong> object (still ggplot-compatible).</li>
</ul>
<p><strong>An example of usage</strong></p>
<p>In the first example, <code><a href="reference/cifplot.html">cifplot()</a></code> called <code><a href="reference/cifpanel.html">cifpanel()</a></code> to combine multiple plots. <code><a href="reference/cifpanel.html">cifpanel()</a></code> is a function for creating a panel with multiple plots like this. <code><a href="reference/cifpanel.html">cifpanel()</a></code> can also display one plot inside another. The cumulative incidence probability for macrovascular complications is low, making it difficult to discern differences between groups. The following code uses <code>inset.panel=</code> to display plot <code>output2</code>, with an enlarged vertical axis, inside plot <code>output1</code>. The position and size of the zoomed-in-view panel is specified by <code>inset.left</code>, <code>inset.bottom</code>, <code>inset.right</code>, and <code>inset.top</code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">output1</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/cifplot.html">cifplot</a></span><span class="op">(</span><span class="fu"><a href="reference/Event.html">Event</a></span><span class="op">(</span><span class="va">t</span>,<span class="va">epsilon</span><span class="op">)</span> <span class="op">~</span> <span class="va">fruitq</span>,</span>
<span>                   data <span class="op">=</span> <span class="va">diabetes.complications</span>,</span>
<span>                   outcome.type<span class="op">=</span><span class="st">"COMPETING-RISK"</span>,</span>
<span>                   code.event1<span class="op">=</span><span class="fl">2</span>,</span>
<span>                   code.event2<span class="op">=</span><span class="fl">1</span>,</span>
<span>                   addConfidenceInterval <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                   addRiskTable <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                   label.y<span class="op">=</span><span class="st">"CIF of macrovascular complications"</span>,</span>
<span>                   label.x<span class="op">=</span><span class="st">"Years from registration"</span><span class="op">)</span></span>
<span><span class="va">output2</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/cifplot.html">cifplot</a></span><span class="op">(</span><span class="fu"><a href="reference/Event.html">Event</a></span><span class="op">(</span><span class="va">t</span>,<span class="va">epsilon</span><span class="op">)</span> <span class="op">~</span> <span class="va">fruitq</span>,</span>
<span>                   data <span class="op">=</span> <span class="va">diabetes.complications</span>,</span>
<span>                   outcome.type<span class="op">=</span><span class="st">"COMPETING-RISK"</span>,</span>
<span>                   code.event1<span class="op">=</span><span class="fl">2</span>,</span>
<span>                   code.event2<span class="op">=</span><span class="fl">1</span>,</span>
<span>                   addConfidenceInterval <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                   addRiskTable <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                   label.y<span class="op">=</span><span class="st">""</span>,</span>
<span>                   label.x<span class="op">=</span><span class="st">""</span>,</span>
<span>                   limits.y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.15</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "type.y in c"</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="va">output3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>a<span class="op">=</span><span class="va">output1</span>, b<span class="op">=</span><span class="va">output2</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/cifpanel.html">cifpanel</a></span><span class="op">(</span>plots <span class="op">=</span> <span class="va">output3</span>,</span>
<span>         title.plot <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Fruit intake and macrovascular complications"</span>, <span class="st">"Zoomed-in view"</span><span class="op">)</span>,</span>
<span>         inset.panel <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>         inset.left <span class="op">=</span> <span class="fl">0.40</span>, inset.bottom <span class="op">=</span> <span class="fl">0.45</span>,</span>
<span>         inset.right <span class="op">=</span> <span class="fl">1.00</span>, inset.top <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>         inset.legend.position <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>         legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-example0-2-1.png" width="100%"></p>
<p>The code below, in which a formula and data is given directly, produces the same output as above.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/cifpanel.html">cifpanel</a></span><span class="op">(</span></span>
<span> title.plot <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Fruit intake and macrovascular complications"</span>, <span class="st">"Zoomed-in view"</span><span class="op">)</span>,</span>
<span> inset.panel <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span> formula <span class="op">=</span> <span class="fu"><a href="reference/Event.html">Event</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">epsilon</span><span class="op">)</span> <span class="op">~</span> <span class="va">fruitq</span>,</span>
<span> data <span class="op">=</span> <span class="va">diabetes.complications</span>,</span>
<span> outcome.type <span class="op">=</span> <span class="st">"COMPETING-RISK"</span>,</span>
<span> code.events <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span>,</span>
<span> label.y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CIF of macrovascular complications"</span>, <span class="st">""</span><span class="op">)</span>,</span>
<span> label.x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Years from registration"</span>, <span class="st">""</span><span class="op">)</span>,</span>
<span> limits.y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.15</span><span class="op">)</span><span class="op">)</span>,</span>
<span> inset.left <span class="op">=</span> <span class="fl">0.40</span>, inset.bottom <span class="op">=</span> <span class="fl">0.45</span>,</span>
<span> inset.right <span class="op">=</span> <span class="fl">1.00</span>, inset.top <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span> inset.legend.position <span class="op">=</span> <span class="st">"none"</span>,</span>
<span> legend.position <span class="op">=</span> <span class="st">"bottom"</span>, </span>
<span> addConfidenceInterval <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="polyreg">polyreg()<a class="anchor" aria-label="anchor" href="#polyreg"></a>
</h3>
<p><code><a href="reference/polyreg.html">polyreg()</a></code> implements <strong>log odds product modeling</strong> for CIFs at user-specified time points, focusing on multiplicative effects of a categorical exposure, or constant effects over time like Cox regression and Fine-Gray models. It estimates multiplicative effects such as <strong>risk ratios</strong>, <strong>odds ratios</strong>, or <strong>subdistribution hazard ratios</strong>, while ensuring that the probabilities across competing events sum to one. This is achieved through <strong>reparameterization using polytomous log odds products</strong>, which fits so-called effect-measure models and nuisance models on multiple competing events simultaneously. Additionally, <code><a href="reference/polyreg.html">polyreg()</a></code> supports direct binomial regression for survival outcomes and the Richardson model for binomial outcomes, both of which use log odds products.</p>
<p>The function follows the familiar <strong>formula + data</strong> syntax with <code><a href="reference/Event.html">Event()</a></code> or <code>Surv()</code> and outputs tidy results, including point estimates, standard errors, confidence intervals, and p-values. Its results can be easily summarized with <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> or combined with tools such as <strong>modelsummary</strong> or <strong>broom</strong> for reporting.</p>
<p><strong>Key arguments</strong></p>
<ul>
<li>
<code>nuisance.model</code> — a formula describing the outcome and nuisance covariates, excluding the exposure of interest.</li>
<li>
<code>exposure</code> — specifies the exposure variable. This argument accepts one binary or categorical variable.</li>
<li>
<code>effect.measure1</code> and <code>effect.measure2</code> — specifies the effect measures for event1 and event2 (<code>"RR"</code>, <code>"OR"</code> or <code>"SHR"</code>).</li>
<li>
<code>outcome.type</code> selects the outcome type (<code>"COMPETING-RISK"</code>, <code>"SURVIVAL"</code>, <code>"BINOMIAL"</code>, <code>"PROPORTIONAL-SURVIVAL"</code> or <code>"PROPORTIONAL-COMPETING-RISK"</code>).</li>
<li>
<code>time.point</code> — specifies time points at which the exposure effect is evaluated. Required for <code>"COMPETING-RISK"</code> and <code>"SURVIVAL"</code> outcomes.</li>
<li>
<code>strata</code> — specifies the stratification variable used to adjust for dependent censoring.</li>
</ul>
<p><strong>Return</strong></p>
<ul>
<li><p><code>coefficient</code> — regression coefficients</p></li>
<li><p><code>cov</code> — variance-covariance matrix for regression coefficients</p></li>
<li><p><code>diagnostic.statistics</code> — a data frame containing inverse probability weights, influence functions, and predicted potential outcomes</p></li>
<li><p><code>summary</code> — a summary of estimated exposure effects</p></li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="example1-unadjusted-competing-risks-analysis">Example1. Unadjusted competing risks analysis<a class="anchor" aria-label="anchor" href="#example1-unadjusted-competing-risks-analysis"></a>
</h2>
<p>For the initial illustration, unadjusted analysis focusing on cumulative incidence of diabetic retinopathy (event 1) and macrovascular complications (event 2) at 8 years of follow-up is demonstrated. To visualize each covariate separately when multiple strata are supplied, set <code>printEachVar = TRUE</code>. Each variable on the right-hand side is plotted in its own panel, and the layout can be controlled with <code>rows.columns.panel</code>. The figure below contrasts the cumulative incidence curves of diabetic retinopathy for quartile <code>fruitq1</code> and a binary exposure <code>fruitq1</code>, low (Q1) and high (Q2 to 4) intake of fruit, generated by <code><a href="reference/cifplot.html">cifplot()</a></code>. The <code>addConfidenceInterval=TRUE</code> argument adds confidence intervals to the plot. This helps visualize the statistical uncertainty of estimated probabilities across exposure levels. When using numeric variables for stratification, discretize them beforehand with <code><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut()</a></code> or <code><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor()</a></code>. The labels of x-axis (Time) and y-axis (Cumulative incidence) in these panels are default labels.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">diabetes.complications</span><span class="op">)</span></span>
<span><span class="va">diabetes.complications</span><span class="op">$</span><span class="va">fruitq1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span></span>
<span>  <span class="va">diabetes.complications</span><span class="op">$</span><span class="va">fruitq</span> <span class="op">==</span> <span class="st">"Q1"</span>,<span class="st">"Q1"</span>,<span class="st">"Q2 to Q4"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/cifplot.html">cifplot</a></span><span class="op">(</span><span class="fu"><a href="reference/Event.html">Event</a></span><span class="op">(</span><span class="va">t</span>,<span class="va">epsilon</span><span class="op">)</span><span class="op">~</span><span class="va">fruitq</span><span class="op">+</span><span class="va">fruitq1</span>, data<span class="op">=</span><span class="va">diabetes.complications</span>, </span>
<span>        outcome.type<span class="op">=</span><span class="st">"COMPETING-RISK"</span>,</span>
<span>        addConfidenceInterval<span class="op">=</span><span class="cn">TRUE</span>, addCensorMark<span class="op">=</span><span class="cn">FALSE</span>, </span>
<span>        addCompetingRiskMark<span class="op">=</span><span class="cn">FALSE</span>, printEachVar <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-example1-1-1.png" width="100%"></p>
<p>In the second graph, censoring marks are added along each curve (<code>addCensorMark = TRUE</code>) to indicate individuals who were censored before experiencing any event. These marks visualize the timing and frequency of censoring, allowing a clearer understanding of loss-to-censoring patterns over follow-up. Here the workflow differs slightly from the previous code. First, we compute a survfit-compatible object <code>output1</code> using <code><a href="reference/cifcurve.html">cifcurve()</a></code> with <code>outcome.type="COMPETING-RISK"</code> by calculating Aalen–Johansen estimator stratified by fruitq1. Then, <code><a href="reference/cifplot.html">cifplot()</a></code> is used to generate the figure. The <code>label.x</code> and <code>label.y</code> arguments are also used to customize the axis labels.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">output1</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/cifcurve.html">cifcurve</a></span><span class="op">(</span><span class="fu"><a href="reference/Event.html">Event</a></span><span class="op">(</span><span class="va">t</span>,<span class="va">epsilon</span><span class="op">)</span><span class="op">~</span><span class="va">fruitq1</span>, data<span class="op">=</span><span class="va">diabetes.complications</span>, </span>
<span>                    outcome.type<span class="op">=</span><span class="st">"COMPETING-RISK"</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/cifplot.html">cifplot</a></span><span class="op">(</span><span class="va">output1</span>, addConfidenceInterval<span class="op">=</span><span class="cn">FALSE</span>, addRiskTable<span class="op">=</span><span class="cn">FALSE</span>, </span>
<span>        addCensorMark<span class="op">=</span><span class="cn">TRUE</span>, addCompetingRiskMark<span class="op">=</span><span class="cn">FALSE</span>, </span>
<span>        label.y<span class="op">=</span><span class="st">"CIF of diabetic retinopathy"</span>, label.x<span class="op">=</span><span class="st">"Years from registration"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-example1-2-1.png" width="100%"></p>
<p>Next, competing risk marks are added (<code>addCompetingRiskMark = TRUE</code>) to indicate individuals who experienced the competing event (macrovascular complications) before diabetic retinopathy. The time points at which the macrovascular complications occurred were obtained as <code>output2</code> for each strata using a helper function <code><a href="reference/extract_time_to_event.html">extract_time_to_event()</a></code>. These symbols help distinguish between events due to the primary cause and those attributable to competing causes. Note that the names of <code>competing.risk.time</code> and <code>intercurrent.event.time</code> must match the strata labels used in the plot if supplied by the user.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">output2</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/extract_time_to_event.html">extract_time_to_event</a></span><span class="op">(</span><span class="fu"><a href="reference/Event.html">Event</a></span><span class="op">(</span><span class="va">t</span>,<span class="va">epsilon</span><span class="op">)</span><span class="op">~</span><span class="va">fruitq1</span>, </span>
<span>                                 data<span class="op">=</span><span class="va">diabetes.complications</span>, which_event<span class="op">=</span><span class="st">"event2"</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/cifplot.html">cifplot</a></span><span class="op">(</span><span class="va">output1</span>, addConfidenceInterval<span class="op">=</span><span class="cn">FALSE</span>, addRiskTable<span class="op">=</span><span class="cn">FALSE</span>, </span>
<span>        addCensorMark<span class="op">=</span><span class="cn">FALSE</span>, addCompetingRiskMark<span class="op">=</span><span class="cn">TRUE</span>, competing.risk.time<span class="op">=</span><span class="va">output2</span>, </span>
<span>        label.y<span class="op">=</span><span class="st">"CIF of diabetic retinopathy"</span>, label.x<span class="op">=</span><span class="st">"Years from registration"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-example1-3-1.png" width="100%"></p>
<p><code>label.strata</code> is an argument for customizing labels, but when inputting a survfit object, it becomes invalid because it does not contain stratum information. Therefore, the following code inputs the formula and data. <code>label.strata</code> is used by combining <code>level.strata</code> and <code>order.strata</code>. <code>level.strata</code> specifies the levels of the stratification variable corresponding to each label in <code>label.strata</code>. The levels specified in <code>level.strata</code> are then displayed in the graph in the order defined by <code>order.strata</code>. A graph enclosed in a square was generated, which is due to <code>style="FRAMED"</code> specification.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/cifplot.html">cifplot</a></span><span class="op">(</span><span class="fu"><a href="reference/Event.html">Event</a></span><span class="op">(</span><span class="va">t</span>,<span class="va">epsilon</span><span class="op">)</span><span class="op">~</span><span class="va">fruitq1</span>, data<span class="op">=</span><span class="va">diabetes.complications</span>, </span>
<span>        outcome.type<span class="op">=</span><span class="st">"COMPETING-RISK"</span>, addConfidenceInterval<span class="op">=</span><span class="cn">FALSE</span>, addRiskTable<span class="op">=</span><span class="cn">FALSE</span>, </span>
<span>        addEstimateTable<span class="op">=</span><span class="cn">TRUE</span>, addCensorMark<span class="op">=</span><span class="cn">FALSE</span>, addCompetingRiskMark<span class="op">=</span><span class="cn">TRUE</span>, </span>
<span>        competing.risk.time<span class="op">=</span><span class="va">output2</span>, label.y<span class="op">=</span><span class="st">"CIF of diabetic retinopathy"</span>, </span>
<span>        label.x<span class="op">=</span><span class="st">"Years from registration"</span>, label.strata<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"High intake"</span>,<span class="st">"Low intake"</span><span class="op">)</span>, </span>
<span>        level.strata<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Q2 to Q4"</span>,<span class="st">"Q1"</span><span class="op">)</span>, order.strata<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Q1"</span>, <span class="st">"Q2 to Q4"</span><span class="op">)</span>, style<span class="op">=</span><span class="st">"FRAMED"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-example1-4-1.png" width="100%"></p>
<p>By specifying <code>addEstimateTable=TRUE</code>, the risks of diabetic retinopathy (estimates for CIFs) along with their confidence interval are shown in the table at the bottom of the graph. The risk ratios at a specific time point for competing events can be jointly and coherently estimated using <code><a href="reference/polyreg.html">polyreg()</a></code> with <code>outcome.type="COMPETING-RISK"</code>. In the code of <code><a href="reference/polyreg.html">polyreg()</a></code> below, no covariates are included in the nuisance model (<code>~1</code> specifies intercept only). The effect of low fruit intake <code>fruitq1</code> is estimated as an unadjusted risk ratio (<code>effect.measure1="RR"</code>) for diabetic retinopathy (event 1) and macrovascular complications (event 2) at 8 years (<code>time.point=8</code>).</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">output3</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/polyreg.html">polyreg</a></span><span class="op">(</span>nuisance.model<span class="op">=</span><span class="fu"><a href="reference/Event.html">Event</a></span><span class="op">(</span><span class="va">t</span>,<span class="va">epsilon</span><span class="op">)</span><span class="op">~</span><span class="fl">1</span>, exposure<span class="op">=</span><span class="st">"fruitq1"</span>, </span>
<span>          data<span class="op">=</span><span class="va">diabetes.complications</span>, effect.measure1<span class="op">=</span><span class="st">"RR"</span>, effect.measure2<span class="op">=</span><span class="st">"RR"</span>, </span>
<span>          time.point<span class="op">=</span><span class="fl">8</span>, outcome.type<span class="op">=</span><span class="st">"COMPETING-RISK"</span>, </span>
<span>          report.nuisance.parameter<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">output3</span><span class="op">$</span><span class="va">coefficient</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] -1.38313159 -0.30043942 -3.99147406 -0.07582595</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">output3</span><span class="op">$</span><span class="va">cov</span><span class="op">)</span></span>
<span><span class="co">#&gt;              [,1]         [,2]         [,3]         [,4]</span></span>
<span><span class="co">#&gt; [1,]  0.017018160 -0.012351309  0.009609321 -0.008372500</span></span>
<span><span class="co">#&gt; [2,] -0.012351309  0.012789187 -0.006012254  0.006540183</span></span>
<span><span class="co">#&gt; [3,]  0.009609321 -0.006012254  0.048161715 -0.044070501</span></span>
<span><span class="co">#&gt; [4,] -0.008372500  0.006540183 -0.044070501  0.055992232</span></span></code></pre></div>
<p>The summaries of analysis results in the list of outputs (e.g. <code>output3$summary</code> below) are compatible with the <code>modelsummary</code> ecosystem, which makes it easy to create publication-ready tables in a variety of formats. A typical workflow is to pass the <code>summary</code> element of a <code><a href="reference/polyreg.html">polyreg()</a></code> fit (or a list of such fits) to <code><a href="https://modelsummary.com/man/msummary.html" class="external-link">modelsummary::msummary()</a></code>. In this case, all regression coefficients are included in summary by setting <code>report.nuisance.parameter = TRUE</code>. Model summaries can also be exponentiated to display risk ratios, odds ratios, or subdistribution hazard ratios using <code>exponentiate</code> option. The summaries can be displayed in the Viewer with customized statistics such as p-values or confidence intervals.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">msummary</span><span class="op">(</span><span class="va">output3</span><span class="op">$</span><span class="va">summary</span>, statistic <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"conf.int"</span>, <span class="st">"p.value"</span><span class="op">)</span>, exponentiate <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<table style="width:99%;" class="table">
<colgroup>
<col style="width: 32%">
<col style="width: 44%">
<col style="width: 22%">
</colgroup>
<thead><tr>
<th>
</th>
<th>
event1
</th>
<th>
event2
</th>
</tr></thead>
<tbody>
<tr>
<td>
Intercept
</td>
<td>
0.251
</td>
<td>
0.018
</td>
</tr>
<tr>
<td>
</td>
<td>
[0.194, 0.324]
</td>
<td>
[0.012, 0.028]
</td>
</tr>
<tr>
<td>
</td>
<td>
(&lt;0.001)
</td>
<td>
(&lt;0.001)
</td>
</tr>
<tr>
<td>
fruitq1, Q2 to Q4 vs 0
</td>
<td>
0.740
</td>
<td>
0.927
</td>
</tr>
<tr>
<td>
</td>
<td>
[0.593, 0.924]
</td>
<td>
[0.583, 1.474]
</td>
</tr>
<tr>
<td>
</td>
<td>
(0.008)
</td>
<td>
(0.749)
</td>
</tr>
<tr>
<td>
effect.measure
</td>
<td>
RR at 8
</td>
<td>
RR at 8
</td>
</tr>
<tr>
<td>
n.events
</td>
<td>
279 in N = 978
</td>
<td>
79 in N = 978
</td>
</tr>
<tr>
<td>
median.follow.up
</td>
<td>
8
</td>
<td>
<ul>
<li>
</li>
</ul>
</td>
</tr>
<tr>
<td>
range.follow.up
</td>
<td>
[ 0.05 , 11 ]
</td>
<td>
<ul>
<li>
</li>
</ul>
</td>
</tr>
<tr>
<td>
n.parameters
</td>
<td>
4
</td>
<td>
<ul>
<li>
</li>
</ul>
</td>
</tr>
<tr>
<td>
converged.by
</td>
<td>
Converged in objective function
</td>
<td>
<ul>
<li>
</li>
</ul>
</td>
</tr>
<tr>
<td>
nleqslv.message
</td>
<td>
Function criterion near zero
</td>
<td>
<ul>
<li>
</li>
</ul>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="example-2-survival-analysis">Example 2. Survival analysis<a class="anchor" aria-label="anchor" href="#example-2-survival-analysis"></a>
</h2>
<p>The second example is time to first event analysis (<code>outcome.type="SURVIVAL"</code>) to estimate the effect on the risk of diabetic retinopathy or macrovascular complications at 8 years. In the code below, <code><a href="reference/cifplot.html">cifplot()</a></code> is directly used to generate a survfit-compatible object internally and plot it.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">diabetes.complications</span><span class="op">$</span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">diabetes.complications</span><span class="op">$</span><span class="va">epsilon</span><span class="op">&gt;</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/cifplot.html">cifplot</a></span><span class="op">(</span><span class="fu"><a href="reference/Event.html">Event</a></span><span class="op">(</span><span class="va">t</span>,<span class="va">d</span><span class="op">)</span><span class="op">~</span><span class="va">fruitq1</span>, data<span class="op">=</span><span class="va">diabetes.complications</span>, </span>
<span>outcome.type<span class="op">=</span><span class="st">"SURVIVAL"</span>, addConfidenceInterval<span class="op">=</span><span class="cn">TRUE</span>, addCensorMark<span class="op">=</span><span class="cn">FALSE</span>, </span>
<span>addCompetingRiskMark<span class="op">=</span><span class="cn">FALSE</span>, label.y<span class="op">=</span><span class="st">"Survival probability"</span>, </span>
<span>label.x<span class="op">=</span><span class="st">"Years from registration"</span>, label.strata<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"High intake"</span>,<span class="st">"Low intake"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-example2-1-1.png" width="100%"></p>
<p>The code below specifies the Richardson model on the risk of diabetic retinopathy or macrovascular complications at 8 years (outcome.type=“SURVIVAL”). Dependent censoring is adjusted by stratified IPCW method (<code>strata='strata'</code>). Estimates other than the effects of exposure (e.g. intercept) are suppressed when <code>report.nuisance.parameter</code> is not specified.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">output4</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/polyreg.html">polyreg</a></span><span class="op">(</span>nuisance.model<span class="op">=</span><span class="fu"><a href="reference/Event.html">Event</a></span><span class="op">(</span><span class="va">t</span>,<span class="va">d</span><span class="op">)</span><span class="op">~</span><span class="fl">1</span>, </span>
<span>          exposure<span class="op">=</span><span class="st">"fruitq1"</span>, strata<span class="op">=</span><span class="st">"strata"</span>, data<span class="op">=</span><span class="va">diabetes.complications</span>,</span>
<span>          effect.measure1<span class="op">=</span><span class="st">"RR"</span>, time.point<span class="op">=</span><span class="fl">8</span>, outcome.type<span class="op">=</span><span class="st">"SURVIVAL"</span><span class="op">)</span></span>
<span><span class="fu">msummary</span><span class="op">(</span><span class="va">output4</span><span class="op">$</span><span class="va">summary</span>, statistic<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"conf.int"</span>, <span class="st">"p.value"</span><span class="op">)</span>, exponentiate<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr>
<th></th>
<th>event 1 (no competing risk)</th>
</tr></thead>
<tbody>
<tr>
<td>fruitq1, Q2 to Q4 vs 0</td>
<td>0.777</td>
</tr>
<tr>
<td></td>
<td>[0.001, 685.697]</td>
</tr>
<tr>
<td></td>
<td>(0.942)</td>
</tr>
<tr>
<td>effect.measure</td>
<td>RR at 8</td>
</tr>
<tr>
<td>n.events</td>
<td>358 in N = 978</td>
</tr>
<tr>
<td>median.follow.up</td>
<td>8</td>
</tr>
<tr>
<td>range.follow.up</td>
<td>[ 0.05 , 11 ]</td>
</tr>
<tr>
<td>n.parameters</td>
<td>2</td>
</tr>
<tr>
<td>converged.by</td>
<td>Converged in objective function</td>
</tr>
<tr>
<td>nleqslv.message</td>
<td>Function criterion near zero</td>
</tr>
</tbody>
</table>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/gestimation/cifmodeling/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/gestimation/cifmodeling/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing cifmodeling</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Shiro Tanaka <br><small class="roles"> Author, maintainer, copyright holder </small>   </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Shiro Tanaka.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
