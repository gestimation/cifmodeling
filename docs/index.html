<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>cifmodeling • cifmodeling</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="cifmodeling">
<meta name="description" content="A compact and unified toolkit for Kaplan–Meier/Aalen–Johansen curves, visualization, and direct polytomous regression for survival and competing risks data.">
<meta property="og:description" content="A compact and unified toolkit for Kaplan–Meier/Aalen–Johansen curves, visualization, and direct polytomous regression for survival and competing risks data.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">cifmodeling</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.8.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/overview.html">Overview</a></li>
    <li><a class="dropdown-item" href="articles/polyreg.html">Direct polytomous regression</a></li>
    <li><a class="dropdown-item" href="articles/examples.html">Examples</a></li>
    <li><a class="dropdown-item" href="articles/information.html">Additional information</a></li>
    <li><a class="dropdown-item" href="articles/arguments.html">Full lists of arguments</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/gestimation/cifmodeling" aria-label="GitHub repository"><span class="fa fa-github"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="visualization-and-modeling-of-survival-and-competing-risks-in-r--cifmodeling">Visualization and Modeling of Survival and Competing Risks in R — cifmodeling<a class="anchor" aria-label="anchor" href="#visualization-and-modeling-of-survival-and-competing-risks-in-r--cifmodeling"></a>
</h1></div>
<div class="section level2">
<h2 id="quick-start">Quick start<a class="anchor" aria-label="anchor" href="#quick-start"></a>
</h2>
<p>This package is a compact, high-level extension of the existing <em>survival</em> ecosystem. It provides a unified interface for Kaplan–Meier and Aalen–Johansen curves, modern visualization, and direct polytomous regression for survival and competing risks data.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://gestimation.github.io/cifmodeling/">cifmodeling</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">diabetes.complications</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/cifplot.html">cifplot</a></span><span class="op">(</span><span class="fu"><a href="reference/Event.html">Event</a></span><span class="op">(</span><span class="va">t</span>,<span class="va">epsilon</span><span class="op">)</span><span class="op">~</span><span class="va">fruitq</span>, data<span class="op">=</span><span class="va">diabetes.complications</span>, </span>
<span>        outcome.type<span class="op">=</span><span class="st">"competing-risk"</span>, panel.per.event<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="reference/figures/README-example01-1-1.png" alt="Aalen–Johansen cumulative incidence curves from cifplot()" width="70%"><p class="caption">
Aalen–Johansen cumulative incidence curves from cifplot()
</p>
</div>
<p>In competing risks data, censoring is often coded as 0, the event of interest as 1, and competing risks as 2. In the <code>diabetes.complications</code> data frame, <code>epsilon</code> follows this convention. With <code>panel.per.event = TRUE</code>, <code><a href="reference/cifplot.html">cifplot()</a></code> visualizes the cumulative incidence functions (CIFs), with the CIF of diabetic retinopathy (<code>epsilon = 1</code>) shown on the left and the CIF of macrovascular complications (<code>epsilon = 2</code>) on the right.</p>
<div class="section level3">
<h3 id="why-cifmodeling">Why cifmodeling?<a class="anchor" aria-label="anchor" href="#why-cifmodeling"></a>
</h3>
<ul>
<li>
<strong>Unified interface</strong> for Kaplan–Meier and Aalen–Johansen curves, with survival and competing risks handled by the same syntax.</li>
<li>
<strong>Publication-ready graphics</strong> built on <code>ggsurvfit</code> and <code>ggplot2</code>, including risk/estimate tables, censoring/competing-risks/intercurrent-events marks, and multi-panel layouts.</li>
<li>
<strong>Coherent regression models</strong> of CIFs, targeting familiar effect measures (risk ratios, odds ratios and subdistribution hazard ratios). Modeling the nuisance structure using polytomous log odds products ensures that the sum of cause-specific CIFs does not exceed one, and enables coherent modelling of the multiplicative effects.</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="tools-for-survival-and-competing-risks-analysis">Tools for survival and competing risks analysis<a class="anchor" aria-label="anchor" href="#tools-for-survival-and-competing-risks-analysis"></a>
</h2>
<p>In clinical and epidemiological research, analysts often need to handle censoring, competing risks, and intercurrent events (e.g. treatment switching), but existing R packages typically separate these tasks across different interfaces. <code>cifmodeling</code> provides a unified, publication-ready toolkit that integrates nonparametric estimation, regression modelling, and visualization for survival and competing risks data. The package is centered around three tightly connected functions:</p>
<ul>
<li><p><code><a href="reference/cifplot.html">cifplot()</a></code> typically generates a survival or CIF curve with marks that represent censoring, competing risks and intercurrent events. Multiple standard error (SE) estimators and confidence interval (CI) methods are supported. The visualization is built on top of <code>ggsurvfit</code> and <code>ggplot2</code>.</p></li>
<li><p><code><a href="reference/cifpanel.html">cifpanel()</a></code> creates a multi-panel figure for survival/CIF curves, arranged either in a grid layout or as an inset overlay.</p></li>
<li><p><code><a href="reference/polyreg.html">polyreg()</a></code> fits coherent regression models of CIFs using polytomous log odds products.</p></li>
</ul>
<p>These functions adopt a formula + data syntax, return tidy, publication-ready outputs, and integrate seamlessly with <code>ggsurvfit</code> and <code>modelsummary</code> for visualization and reporting.</p>
</div>
<div class="section level2">
<h2 id="position-in-the-survival-ecosystem">Position in the survival ecosystem<a class="anchor" aria-label="anchor" href="#position-in-the-survival-ecosystem"></a>
</h2>
<p>Several excellent R packages exist for survival and competing risks analysis. The <strong>survival</strong> package provides the canonical API for survival data. In combination with <strong>ggsurvfit</strong>, <code><a href="https://rdrr.io/pkg/survival/man/survfit.html" class="external-link">survival::survfit()</a></code> can produce publication-ready survival plots. For CIF plots, however, integration in the general ecosystem is less streamlined. <code>cifmodeling</code> fills this gap by offering <code><a href="reference/cifplot.html">cifplot()</a></code> for survival/CIF plots and multi-panel figures via a single, unified interface.</p>
<p>Beyond providing a unified interface, <code><a href="reference/cifcurve.html">cifcurve()</a></code> also extends <code><a href="https://rdrr.io/pkg/survival/man/survfit.html" class="external-link">survival::survfit()</a></code> in a few targeted ways. For unweighted survival data, it reproduces the standard Kaplan–Meier estimator with Greenwood or Tsiatis SEs and a unified set of CI transformations. For competing risks data, it computes Aalen–Johansen CIFs with both Aalen-type and delta-method SEs. For weighted survival or competing risks data (e.g. inverse probability weighting), it implements influence-function based SEs (Deng and Wang 2025) as well as modified Greenwood- and Tsiatis-type SEs (Xie and Liu 2005), which are valid under general positive weights.</p>
<p>If you need very fine-grained plot customisation, you can compute the estimator and keep a <code>survfit</code>-compatible object with <code><a href="reference/cifcurve.html">cifcurve()</a></code> (or supply your own <code>survfit</code> object) and then style it using <strong>ggsurvfit</strong>/<strong>ggplot2</strong> layers. In other words:</p>
<ul>
<li>use <code><a href="reference/cifcurve.html">cifcurve()</a></code> for estimation,</li>
<li>use <code><a href="reference/cifplot.html">cifplot()</a></code> / <code><a href="reference/cifpanel.html">cifpanel()</a></code> for quick, high-quality figures, and</li>
<li>fall back to the ggplot ecosystem when you want full artistic control.</li>
</ul>
<p>The <strong>mets</strong> package is a more specialised toolkit that provides advanced methods for competing risks analysis. <code><a href="reference/polyreg.html">cifmodeling::polyreg()</a></code> focuses on coherent modelling of all CIFs simultaneously to estimate RR/OR/SHR at user-specified times. This coherence can come with longer runtimes for large problems. If you prefer fitting separate regression models for each competing event or specifically need Fine–Gray models (Fine and Gray 1999) and direct binomial model (Scheike, Zhang and Gerds 2008), <code><a href="https://kkholst.github.io/mets/reference/cifreg.html" class="external-link">mets::cifreg()</a></code> and <code><a href="https://kkholst.github.io/mets/reference/binreg.html" class="external-link">mets::binreg()</a></code> are excellent choices.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>The package is implemented in R and relies on <code>Rcpp</code>, <code>nleqslv</code> and <code>boot</code> for its numerical back-end. The examples in this document also use <code>ggplot2</code>, <code>ggsurvfit</code>, <code>patchwork</code> and <code>modelsummary</code> for tabulation and plotting. Install the core package and these companion packages with:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install cifmodeling from GitHub</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"gestimation/cifmodeling"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Core dependencies</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Rcpp"</span>, <span class="st">"nleqslv"</span>, <span class="st">"boot"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Recommended packages for plotting and tabulation in this README</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ggplot2"</span>, <span class="st">"ggsurvfit"</span>, <span class="st">"patchwork"</span>, <span class="st">"modelsummary"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="quality-control">Quality control<a class="anchor" aria-label="anchor" href="#quality-control"></a>
</h2>
<p><code>cifmodeling</code> includes an extensive test suite built with <strong>testthat</strong>, which checks the numerical accuracy and graphical consistency of all core functions (<code><a href="reference/cifcurve.html">cifcurve()</a></code>, <code><a href="reference/cifplot.html">cifplot()</a></code>, <code><a href="reference/cifpanel.html">cifpanel()</a></code>, and <code><a href="reference/polyreg.html">polyreg()</a></code>). The estimators are routinely compared against related functions in <strong>survival</strong>, <strong>cmprsk</strong> and <strong>mets</strong> packages to ensure consistency. The package is continuously tested on GitHub Actions (Windows, macOS, Linux) to maintain reproducibility and CRAN-level compliance.</p>
</div>
<div class="section level2">
<h2 id="an-example-of-competing-risks-analysis">An example of competing risks analysis<a class="anchor" aria-label="anchor" href="#an-example-of-competing-risks-analysis"></a>
</h2>
<p>For the initial illustration, we focus on unadjusted cumulative incidence of diabetic retinopathy (event 1) and macrovascular complications (event 2) at 8 years of follow-up. To visualize each covariate separately when multiple strata are supplied, set <code>panel.per.variable = TRUE</code>. Each variable on the right-hand side is plotted in its own panel, and the layout can be controlled with <code>rows.columns.panel</code>. The figure below contrasts the CIFs of diabetic retinopathy for the quartiles <code>fruitq</code> and a binary exposure <code>fruitq1</code>, low (Q1) and high (Q2 to 4) intake of fruit, generated by <code><a href="reference/cifplot.html">cifplot()</a></code>. The <code>add.conf=TRUE</code> argument adds CIs to the plot. This helps visualize the statistical uncertainty of estimated probabilities across exposure levels. When using numeric variables for stratification, discretize them beforehand with <code><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut()</a></code> or <code><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor()</a></code>. The labels of x-axis (Time) and y-axis (Cumulative incidence) in these panels are default labels.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">diabetes.complications</span><span class="op">)</span></span>
<span><span class="va">diabetes.complications</span><span class="op">$</span><span class="va">fruitq1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span></span>
<span>  <span class="va">diabetes.complications</span><span class="op">$</span><span class="va">fruitq</span> <span class="op">==</span> <span class="st">"Q1"</span>,<span class="st">"Q1"</span>,<span class="st">"Q2 to Q4"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/cifplot.html">cifplot</a></span><span class="op">(</span><span class="fu"><a href="reference/Event.html">Event</a></span><span class="op">(</span><span class="va">t</span>,<span class="va">epsilon</span><span class="op">)</span><span class="op">~</span><span class="va">fruitq</span><span class="op">+</span><span class="va">fruitq1</span>, data<span class="op">=</span><span class="va">diabetes.complications</span>, </span>
<span>        outcome.type<span class="op">=</span><span class="st">"competing-risk"</span>,</span>
<span>        add.conf<span class="op">=</span><span class="cn">TRUE</span>, add.censor.mark<span class="op">=</span><span class="cn">FALSE</span>, </span>
<span>        add.competing.risk.mark<span class="op">=</span><span class="cn">FALSE</span>, panel.per.variable<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="reference/figures/README-example04-1-1-1.png" alt="Cumulative incidence curves per each stratification variable" width="70%"><p class="caption">
Cumulative incidence curves per each stratification variable
</p>
</div>
<p>In the second figure, censoring marks are added along each curve (<code>add.censor.mark = TRUE</code>) to indicate individuals who were censored before experiencing any event. These marks visualize the timing and frequency of censoring, allowing a clearer understanding of loss-to-censoring patterns over follow-up. Here the workflow differs slightly from the previous code. First, we compute a survfit-compatible object <code>output1</code> using <code><a href="reference/cifcurve.html">cifcurve()</a></code> with <code>outcome.type="competing-risk"</code> by calculating the Aalen–Johansen estimator stratified by <code>fruitq1</code>. Then, <code><a href="reference/cifplot.html">cifplot()</a></code> is used to generate the figure. The <code>label.y</code>, <code>label.x</code> and <code>limit.x</code> arguments are also used to customize the axis labels and limits.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">output1</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/cifcurve.html">cifcurve</a></span><span class="op">(</span><span class="fu"><a href="reference/Event.html">Event</a></span><span class="op">(</span><span class="va">t</span>,<span class="va">epsilon</span><span class="op">)</span><span class="op">~</span><span class="va">fruitq1</span>, data<span class="op">=</span><span class="va">diabetes.complications</span>, </span>
<span>                    outcome.type<span class="op">=</span><span class="st">"competing-risk"</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/cifplot.html">cifplot</a></span><span class="op">(</span><span class="va">output1</span>, add.conf<span class="op">=</span><span class="cn">FALSE</span>, add.risktable<span class="op">=</span><span class="cn">FALSE</span>, </span>
<span>        add.censor.mark<span class="op">=</span><span class="cn">TRUE</span>, add.competing.risk.mark<span class="op">=</span><span class="cn">FALSE</span>, </span>
<span>        label.y<span class="op">=</span><span class="st">"CIF of diabetic retinopathy"</span>, label.x<span class="op">=</span><span class="st">"Years from registration"</span>,</span>
<span>        limits.x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">8</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="reference/figures/README-example04-1-2-1.png" alt="Cumulative incidence curves with censor marks and axis labels" width="70%"><p class="caption">
Cumulative incidence curves with censor marks and axis labels
</p>
</div>
<p>Next, competing risk marks are added (<code>add.competing.risk.mark = TRUE</code>) to indicate individuals who experienced the competing event (macrovascular complications) before diabetic retinopathy. The time points at which the macrovascular complications occurred were obtained as <code>output2</code> for each strata using a helper function <code><a href="reference/extract_time_to_event.html">extract_time_to_event()</a></code>. These symbols help distinguish between events due to the primary cause and those attributable to competing causes. Note that the names of <code>competing.risk.time</code> and <code>intercurrent.event.time</code> must match the strata labels used in the plot if supplied by the user.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">output2</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/extract_time_to_event.html">extract_time_to_event</a></span><span class="op">(</span><span class="fu"><a href="reference/Event.html">Event</a></span><span class="op">(</span><span class="va">t</span>,<span class="va">epsilon</span><span class="op">)</span><span class="op">~</span><span class="va">fruitq1</span>, </span>
<span>                                 data<span class="op">=</span><span class="va">diabetes.complications</span>, which_event<span class="op">=</span><span class="st">"event2"</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/cifplot.html">cifplot</a></span><span class="op">(</span><span class="va">output1</span>, add.conf<span class="op">=</span><span class="cn">FALSE</span>, add.risktable<span class="op">=</span><span class="cn">FALSE</span>, </span>
<span>        add.censor.mark<span class="op">=</span><span class="cn">FALSE</span>, add.competing.risk.mark<span class="op">=</span><span class="cn">TRUE</span>, competing.risk.time<span class="op">=</span><span class="va">output2</span>, </span>
<span>        label.y<span class="op">=</span><span class="st">"CIF of diabetic retinopathy"</span>, label.x<span class="op">=</span><span class="st">"Years from registration"</span>,</span>
<span>        limits.x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">8</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="reference/figures/README-example04-1-3-1.png" alt="Cumulative incidence curves with competing risk marks" width="70%"><p class="caption">
Cumulative incidence curves with competing risk marks
</p>
</div>
<p>The <code>label.strata</code> is another argument for customizing labels, but when inputting a survfit object, it becomes invalid because it does not contain stratum information. Therefore, the following code inputs the formula and data. <code>label.strata</code> is used by combining <code>level.strata</code> and <code>order.strata</code>. <code>level.strata</code> specifies the levels of the stratification variable corresponding to each label in <code>label.strata</code>. The levels specified in <code>level.strata</code> are then displayed in the figure in the order defined by <code>order.strata</code>. A figure enclosed in a square was generated, which is due to <code>style="framed"</code> specification.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/cifplot.html">cifplot</a></span><span class="op">(</span><span class="fu"><a href="reference/Event.html">Event</a></span><span class="op">(</span><span class="va">t</span>,<span class="va">epsilon</span><span class="op">)</span><span class="op">~</span><span class="va">fruitq1</span>, data<span class="op">=</span><span class="va">diabetes.complications</span>, </span>
<span>        outcome.type<span class="op">=</span><span class="st">"competing-risk"</span>, add.conf<span class="op">=</span><span class="cn">FALSE</span>, add.risktable<span class="op">=</span><span class="cn">FALSE</span>, </span>
<span>        add.estimate.table<span class="op">=</span><span class="cn">TRUE</span>, add.censor.mark<span class="op">=</span><span class="cn">FALSE</span>, add.competing.risk.mark<span class="op">=</span><span class="cn">TRUE</span>, </span>
<span>        competing.risk.time<span class="op">=</span><span class="va">output2</span>, label.y<span class="op">=</span><span class="st">"CIF of diabetic retinopathy"</span>, </span>
<span>        label.x<span class="op">=</span><span class="st">"Years from registration"</span>, limits.x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">8</span><span class="op">)</span>,</span>
<span>        label.strata<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"High intake"</span>,<span class="st">"Low intake"</span><span class="op">)</span>, level.strata<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Q2 to Q4"</span>,<span class="st">"Q1"</span><span class="op">)</span>, </span>
<span>        order.strata<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Q1"</span>, <span class="st">"Q2 to Q4"</span><span class="op">)</span>, style<span class="op">=</span><span class="st">"framed"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="reference/figures/README-example04-1-4-1.png" alt="Cumulative incidence curves with strata labels and FRAMED style" width="70%"><p class="caption">
Cumulative incidence curves with strata labels and FRAMED style
</p>
</div>
<p>By specifying <code>add.estimate.table = TRUE</code>, the risks of diabetic retinopathy (estimates for CIFs) along with their CIs are shown in the table at the bottom of the figure. Risk ratios at a specific time point (e.g. 8 years) for all competing events can be jointly and coherently estimated using <code><a href="reference/polyreg.html">polyreg()</a></code> with <code>outcome.type="competing-risk"</code>. In the code of <code><a href="reference/polyreg.html">polyreg()</a></code> below, no covariates are included in the nuisance model (<code>~1</code> specifies intercept only). The effect of low fruit intake <code>fruitq1</code> is estimated as an unadjusted risk ratio (<code>effect.measure1="RR"</code>) for diabetic retinopathy (event 1) and macrovascular complications (event 2) at 8 years (<code>time.point=8</code>).</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">output3</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/polyreg.html">polyreg</a></span><span class="op">(</span>nuisance.model<span class="op">=</span><span class="fu"><a href="reference/Event.html">Event</a></span><span class="op">(</span><span class="va">t</span>,<span class="va">epsilon</span><span class="op">)</span><span class="op">~</span><span class="fl">1</span>, exposure<span class="op">=</span><span class="st">"fruitq1"</span>, </span>
<span>          data<span class="op">=</span><span class="va">diabetes.complications</span>, effect.measure1<span class="op">=</span><span class="st">"RR"</span>, effect.measure2<span class="op">=</span><span class="st">"RR"</span>, </span>
<span>          time.point<span class="op">=</span><span class="fl">8</span>, outcome.type<span class="op">=</span><span class="st">"competing-risk"</span>, </span>
<span>          report.nuisance.parameter<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">output3</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] -1.38313159 -0.30043942 -3.99147406 -0.07582595</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">output3</span><span class="op">)</span></span>
<span><span class="co">#&gt;              [,1]         [,2]         [,3]         [,4]</span></span>
<span><span class="co">#&gt; [1,]  0.017018160 -0.012351309  0.009609321 -0.008372500</span></span>
<span><span class="co">#&gt; [2,] -0.012351309  0.012789187 -0.006012254  0.006540183</span></span>
<span><span class="co">#&gt; [3,]  0.009609321 -0.006012254  0.048161715 -0.044070501</span></span>
<span><span class="co">#&gt; [4,] -0.008372500  0.006540183 -0.044070501  0.055992232</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">output3</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                       event1        event2      </span></span>
<span><span class="co">#&gt; ---------------------------------------------- </span></span>
<span><span class="co">#&gt; Intercept            </span></span>
<span><span class="co">#&gt;                       0.251         0.018       </span></span>
<span><span class="co">#&gt;                       [0.194, 0.324]  [0.012, 0.028]</span></span>
<span><span class="co">#&gt;                       (p=0.000)     (p=0.000)   </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; fruitq1, Q2 to Q4 vs 0 </span></span>
<span><span class="co">#&gt;                       0.740         0.927       </span></span>
<span><span class="co">#&gt;                       [0.593, 0.924]  [0.583, 1.474]</span></span>
<span><span class="co">#&gt;                       (p=0.008)     (p=0.749)   </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------------------------------------------- </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; effect.measure        RR at 8       RR at 8     </span></span>
<span><span class="co">#&gt; n.events              279 in N = 978  79 in N = 978</span></span>
<span><span class="co">#&gt; median.follow.up      8             -           </span></span>
<span><span class="co">#&gt; range.follow.up       [0.05, 11.00]  -           </span></span>
<span><span class="co">#&gt; n.parameters          4             -           </span></span>
<span><span class="co">#&gt; converged.by          Converged in objective function  -           </span></span>
<span><span class="co">#&gt; nleqslv.message       Function criterion near zero  -</span></span></code></pre></div>
<p>The <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> method prints an event-wise table of point estimates, CIs, and p-values. Internally, this table is stored in a <code>summary</code> component of the <code>"polyreg"</code> object, which is compatible with the <code>modelsummary</code> ecosystem. If you want more elaborate tables, you can optionally pass this object to <code><a href="https://modelsummary.com/man/msummary.html" class="external-link">modelsummary::msummary()</a></code>. In this case, all regression coefficients are included in the summary by setting <code>report.nuisance.parameter = TRUE</code>. Model summaries can also be exponentiated to display risk ratios, odds ratios, or subdistribution hazard ratios using the <code>exponentiate</code> option.</p>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/gestimation/cifmodeling/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/gestimation/cifmodeling/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing cifmodeling</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Shiro Tanaka <br><small class="roles"> Author, maintainer, copyright holder </small> <a href="https://orcid.org/0000-0001-6817-5235" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Shiro Tanaka.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
