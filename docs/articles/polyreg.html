<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Direct polytomous regression • cifmodeling</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Direct polytomous regression">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">cifmodeling</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.8.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/overview.html">Overview</a></li>
    <li><a class="dropdown-item" href="../articles/polyreg.html">Direct polytomous regression</a></li>
    <li><a class="dropdown-item" href="../articles/formula.html">Computational formulas in cifcurve()</a></li>
    <li><a class="dropdown-item" href="../articles/examples.html">Examples</a></li>
    <li><a class="dropdown-item" href="../articles/gallery.html">Gallery</a></li>
    <li><a class="dropdown-item" href="../articles/information.html">Additional information</a></li>
    <li><a class="dropdown-item" href="../articles/arguments.html">Full lists of arguments</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/gestimation/cifmodeling" aria-label="GitHub repository"><span class="fa fa-github"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Direct polytomous regression</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/gestimation/cifmodeling/blob/HEAD/vignettes/polyreg.Rmd" class="external-link"><code>vignettes/polyreg.Rmd</code></a></small>
      <div class="d-none name"><code>polyreg.Rmd</code></div>
    </div>

    
    
<!-- badges: start -->
<!-- badges: end -->
<div class="section level2">
<h2 id="why-direct-modeling-of-cifs">Why direct modeling of CIFs?<a class="anchor" aria-label="anchor" href="#why-direct-modeling-of-cifs"></a>
</h2>
<p>In survival analysis, users often interpret the results through plots
of cumulative incidence: <em>how far apart are the CIF curves at a given
time, and how does this separation evolve over follow-up?</em> Standard
Fine-Gray models, however, parameterize <strong>subdistribution
hazards</strong>, whose regression coefficients are only indirectly
related to the observed differences between CIF curves for the event of
interest. This makes it difficult to interpret the model on the
probability scale and to quantify effects on all competing events.</p>
<p>Direct polytomous regression was motivated by this gap. It models
<strong>all cause-specific CIFs jointly</strong>, parameterizing the
nuisance structure (i.e. a model of confounders) with polytomous log
odds products. It also targets <strong>effect measures on the CIF scale
itself</strong>: at user-specified time points it estimates ratios of
CIFs (risk ratios, odds ratios, subdistribution hazard ratios), and in
proportional-effect settings it compares CIFs in terms of a constant
ratio over time. As a result, the regression parameters are much more
directly aligned with what is visible in CIF curves.</p>
</div>
<div class="section level2">
<h2 id="coherent-modeling-of-cifs-using-polytomous-log-odds-products">Coherent modeling of CIFs using polytomous log odds products<a class="anchor" aria-label="anchor" href="#coherent-modeling-of-cifs-using-polytomous-log-odds-products"></a>
</h2>
<p>Standard semiparametric regression approaches that fit separate
models for each cause have two drawbacks in competing risks settings:
they may lose efficiency by ignoring the correlation between causes, and
they can be <strong>incoherent</strong> in the sense that the implied
cause-specific CIFs do not necessarily sum to at most one. Direct
polytomous regression addresses these challenges by
<strong>log-odds-product modeling of all cause-specific CIFs</strong>
(Richardson, Robins and Wang 2017). It introduces a nuisance model
specified as <strong>polytomous log odds products</strong> in addition
to the model for effect measures (e.g., risk ratios for the exposure),
so that the sum restriction on CIFs is enforced naturally. This model
specification is equivalent to the Richardson model in the case of
uncensored binary outcome (Richardson, Robins and Wang 2017). The same
framework applies both to models with common multiplicative effects over
time and to models targeting effects at specific time points.</p>
<p>The models in <code>polyreg</code> are specified by three main
components:</p>
<ul>
<li><p>Nuisance model: Describes the relationship between outcomes and
covariates (excluding exposure).</p></li>
<li><p>Effect measures and time points: Defines the exposure effects to
be estimated and the time point of interest if necessary.</p></li>
<li><p>Censoring adjustment: Specifies strata for inverse probability
weighting to adjust for dependent censoring.</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="nuisance-model">1. Nuisance model<a class="anchor" aria-label="anchor" href="#nuisance-model"></a>
</h2>
<p>The <code>nuisance.model</code> argument specifies the formula
linking the outcome to covariates. Its format depends on the outcome
type:</p>
<ul>
<li><p>Competing risks or survival outcome: Use <code>Surv()</code> or
<code><a href="../reference/Event.html">Event()</a></code> with time and status variables.</p></li>
<li><p>Binomial outcome: Use standard R formula notation.</p></li>
</ul>
<p>Default event codes:</p>
<ul>
<li><p>Competing risks outcome: 1 and 2 for event types, 0 for
censoring.</p></li>
<li><p>Survival outcome: 1 for events, 0 for censoring.</p></li>
<li><p>Binomial outcome: 0 and 1.</p></li>
</ul>
<p>Event codes can be customized using <code>code.event1</code>,
<code>code.event2</code>, and <code>code.censoring</code>. The
<code>outcome.type</code> argument must be set to:</p>
<ul>
<li><p>Effects on CIFs at a specific time:
<code>"competing-risk"</code></p></li>
<li><p>Effects on a risk at a specific time:
<code>"survival"</code></p></li>
<li><p>Constant effects on CIFs over time:
<code>"proportional-competing-risk"</code></p></li>
<li><p>Constant effects on a risk over time:
<code>"proportional-survival"</code></p></li>
<li><p>Effects on a risk of a binomial outcome:
<code>"binomial"</code></p></li>
</ul>
<p>Covariates included in <code>nuisance.model</code> should adjust for
confounding factors to obtain unbiased exposure effect estimates.</p>
</div>
<div class="section level2">
<h2 id="effect-measures-and-time-points">2. Effect measures and time points<a class="anchor" aria-label="anchor" href="#effect-measures-and-time-points"></a>
</h2>
<p>Three effect measures available:</p>
<ul>
<li><p>Risk ratio (RR)</p></li>
<li><p>Odds ratio (OR)</p></li>
<li><p>Subdistribution hazard ratio (SHR)</p></li>
</ul>
<p>Set the desired measure using <code>effect.measure1</code> and, for
competing risks analysis, <code>effect.measure2</code>. The
<code>time.point</code> argument specifies the follow-up time at which
effects are estimated.</p>
</div>
<div class="section level2">
<h2 id="censoring-adjustment">3. Censoring adjustment<a class="anchor" aria-label="anchor" href="#censoring-adjustment"></a>
</h2>
<p>The IPCW method is used to adjust for dependent censoring. Use
<code>strata=</code> to specify stratification variables. If no strata
are specified, Kaplan-Meier weights are used.</p>
</div>
<div class="section level2">
<h2 id="estimator-and-confidence-intervals">Estimator and confidence intervals<a class="anchor" aria-label="anchor" href="#estimator-and-confidence-intervals"></a>
</h2>
<p>In <code><a href="../reference/polyreg.html">polyreg()</a></code>, the regression parameters are calculated
by the stratified IPCW estimators, which asymptotically achieve minimum
variance within a class of augmented IPCW estimators, without the
computational burden of deriving augmentation terms for each cause. For
confidence intervals, <code><a href="../reference/polyreg.html">polyreg()</a></code> normally chooses a single,
simple method based on <code>outcome.type</code>:</p>
<ul>
<li>
<code>"competing-risk"</code>, <code>"survival"</code>,
<code>"binomial"</code>: Wald CIs based on sandwich variance</li>
<li>
<code>"proportional-competing-risk"</code>,
<code>"proportional-survival"</code>: Bootstrap CIs (normal
approximation)</li>
</ul>
<p>For time-point (non-proportional) models, the default is Wald CIs
using a sandwich variance directly from influence functions. If
<code>report.boot.conf = TRUE</code>, the variance is instead estimated
by a wild (multiplier) bootstrap applied to the influence functions
(<code>boot.multiplier</code>, boot.replications), and Wald CIs are
formed from that bootstrap variance. For common effects (proportional
models), <code>boot()</code> refits the estimator in each replicate and
forms normal-approximate CIs from the bootstrap mean and SD. If desired,
BCa CIs can be requested via <code>boot.bca = TRUE</code> (only for
proportional models). Users normally do not need to set any CI
flags.</p>
</div>
<div class="section level2">
<h2 id="return">Return<a class="anchor" aria-label="anchor" href="#return"></a>
</h2>
<p>This function returns an object of class <code>"polyreg"</code> with
the following main components:</p>
<ul>
<li><p><code>coef</code>: regression coefficients on the chosen
effect-measure scale.</p></li>
<li><p><code>vcov</code>: variance–covariance matrix for the regression
coefficients.</p></li>
<li><p><code>diagnostic.statistics</code>: a data frame containing
inverse probability weights, influence functions, and predicted
potential outcomes for individual observations.</p></li>
<li><p><code>summary</code>: a list of event-wise <em>tidy</em> and
<em>glance</em> tables summarising the estimated exposure
effects.</p></li>
</ul>
<p>In practice, users are expected to work with the usual S3
methods:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span>         <span class="co"># regression coefficients</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span>         <span class="co"># variance–covariance matrix</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/nobs.html" class="external-link">nobs</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span>         <span class="co"># number of observations used in the fit</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span>      <span class="co"># formatted, event-wise table printed to the console</span></span></code></pre></div>
<p>Calling <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> on a “polyreg” object prints a
modelsummary-like table of point estimates, CIs, and p-values for each
event, and returns the underlying summary list invisibly. The summary
component can be passed to external tools such as
<code>modelsummary</code> or <code>broom</code> for additional
formatting if desired, but no external packages are required to inspect
the model fit.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Shiro Tanaka.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
