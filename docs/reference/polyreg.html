<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Fit coherent regression models of CIFs using polytomous log odds products — polyreg • cifmodeling</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fit coherent regression models of CIFs using polytomous log odds products — polyreg"><meta name="description" content="polyreg() fits regression models of CIFs, targeting familiar effect measures
(risk ratios, odds ratios and subdistribution hazard ratios).
Modeling the nuisance structure using polytomous log odds products ensures that
the sum of cause-specific CIFs does not exceed one, and enables coherent modelling
of the multiplicative effects.
This function follows a familiar formula–data workflow: the outcome and
covariates other than the exposure are specified through a formula in nuisance.model
(with Event() or survival::Surv() on the LHS), and the exposure of interest
is given by a separate variable name in exposure. The fitted object contains
tidy summaries of exposure effects (point estimates, SEs, CIs, and p-values)
and can be summarised with summary.polyreg() or formatted with external tools
such as modelsummary::modelsummary()."><meta property="og:description" content="polyreg() fits regression models of CIFs, targeting familiar effect measures
(risk ratios, odds ratios and subdistribution hazard ratios).
Modeling the nuisance structure using polytomous log odds products ensures that
the sum of cause-specific CIFs does not exceed one, and enables coherent modelling
of the multiplicative effects.
This function follows a familiar formula–data workflow: the outcome and
covariates other than the exposure are specified through a formula in nuisance.model
(with Event() or survival::Surv() on the LHS), and the exposure of interest
is given by a separate variable name in exposure. The fitted object contains
tidy summaries of exposure effects (point estimates, SEs, CIs, and p-values)
and can be summarised with summary.polyreg() or formatted with external tools
such as modelsummary::modelsummary()."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">cifmodeling</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.8.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/overview.html">Overview</a></li>
    <li><a class="dropdown-item" href="../articles/polyreg.html">Direct polytomous regression</a></li>
    <li><a class="dropdown-item" href="../articles/examples.html">Examples</a></li>
    <li><a class="dropdown-item" href="../articles/information.html">Additional information</a></li>
    <li><a class="dropdown-item" href="../articles/arguments.html">Full lists of arguments</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/gestimation/cifmodeling" aria-label="GitHub repository"><span class="fa fa-github"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Fit coherent regression models of CIFs using polytomous log odds products</h1>
      <small class="dont-index">Source: <a href="https://github.com/gestimation/cifmodeling/blob/HEAD/R/polyreg.R" class="external-link"><code>R/polyreg.R</code></a></small>
      <div class="d-none name"><code>polyreg.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>polyreg()</code> fits regression models of CIFs, targeting familiar effect measures
(risk ratios, odds ratios and subdistribution hazard ratios).
Modeling the nuisance structure using polytomous log odds products ensures that
the sum of cause-specific CIFs does not exceed one, and enables coherent modelling
of the multiplicative effects.</p>
<p>This function follows a familiar formula–data workflow: the outcome and
covariates other than the exposure are specified through a formula in <code>nuisance.model</code>
(with <code><a href="Event.html">Event()</a></code> or <code><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">survival::Surv()</a></code> on the LHS), and the exposure of interest
is given by a separate variable name in <code>exposure</code>. The fitted object contains
tidy summaries of exposure effects (point estimates, SEs, CIs, and p-values)
and can be summarised with <code><a href="polyreg-methods.html">summary.polyreg()</a></code> or formatted with external tools
such as <code><a href="https://modelsummary.com/man/modelsummary.html" class="external-link">modelsummary::modelsummary()</a></code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">polyreg</span><span class="op">(</span></span>
<span>  <span class="va">nuisance.model</span>,</span>
<span>  <span class="va">exposure</span>,</span>
<span>  strata <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  subset.condition <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  na.action <span class="op">=</span> <span class="va">na.omit</span>,</span>
<span>  code.event1 <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  code.event2 <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  code.censoring <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  code.exposure.ref <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  effect.measure1 <span class="op">=</span> <span class="st">"RR"</span>,</span>
<span>  effect.measure2 <span class="op">=</span> <span class="st">"RR"</span>,</span>
<span>  time.point <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  outcome.type <span class="op">=</span> <span class="st">"competing-risk"</span>,</span>
<span>  conf.int <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  report.nuisance.parameter <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  report.optim.convergence <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  report.sandwich.conf <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  report.boot.conf <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  boot.bca <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  boot.multiplier <span class="op">=</span> <span class="st">"rademacher"</span>,</span>
<span>  boot.replications <span class="op">=</span> <span class="fl">200</span>,</span>
<span>  boot.seed <span class="op">=</span> <span class="fl">46</span>,</span>
<span>  nleqslv.method <span class="op">=</span> <span class="st">"Newton"</span>,</span>
<span>  optim.parameter1 <span class="op">=</span> <span class="fl">1e-06</span>,</span>
<span>  optim.parameter2 <span class="op">=</span> <span class="fl">1e-06</span>,</span>
<span>  optim.parameter3 <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  optim.parameter4 <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  optim.parameter5 <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  optim.parameter6 <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  optim.parameter7 <span class="op">=</span> <span class="fl">1e-10</span>,</span>
<span>  optim.parameter8 <span class="op">=</span> <span class="fl">1e-06</span>,</span>
<span>  optim.parameter9 <span class="op">=</span> <span class="fl">1e-06</span>,</span>
<span>  optim.parameter10 <span class="op">=</span> <span class="fl">40</span>,</span>
<span>  optim.parameter11 <span class="op">=</span> <span class="fl">0.025</span>,</span>
<span>  optim.parameter12 <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  optim.parameter13 <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  data.initial.values <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  normalize.covariate <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  terminate.time.point <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  prob.bound <span class="op">=</span> <span class="fl">1e-07</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-nuisance-model">nuisance.model<a class="anchor" aria-label="anchor" href="#arg-nuisance-model"></a></dt>
<dd><p>A <code>formula</code> describing the outcome and
nuisance covariates, excluding the exposure of interest.
The LHS must be <code>Event(time, status)</code> or <code>survival::Surv(time, status)</code>.</p></dd>


<dt id="arg-exposure">exposure<a class="anchor" aria-label="anchor" href="#arg-exposure"></a></dt>
<dd><p>A character string giving the name of the categorical exposure
variable in <code>data</code>.</p></dd>


<dt id="arg-strata">strata<a class="anchor" aria-label="anchor" href="#arg-strata"></a></dt>
<dd><p>Optional character string with the name of the stratification
variable used to adjust for dependent censoring (default <code>NULL</code>).</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A data frame containing the outcome, exposure and nuisance
covariates referenced by <code>nuisance.model</code>.</p></dd>


<dt id="arg-subset-condition">subset.condition<a class="anchor" aria-label="anchor" href="#arg-subset-condition"></a></dt>
<dd><p>Optional character string giving a logical condition to subset
<code>data</code> (default <code>NULL</code>).</p></dd>


<dt id="arg-na-action">na.action<a class="anchor" aria-label="anchor" href="#arg-na-action"></a></dt>
<dd><p>A function specifying the action to take on missing values (default <code>na.omit</code>).</p></dd>


<dt id="arg-code-event-">code.event1<a class="anchor" aria-label="anchor" href="#arg-code-event-"></a></dt>
<dd><p>Integer code of the event of interest (default <code>1</code>).</p></dd>


<dt id="arg-code-event-">code.event2<a class="anchor" aria-label="anchor" href="#arg-code-event-"></a></dt>
<dd><p>Integer code of the competing event (default <code>2</code>).</p></dd>


<dt id="arg-code-censoring">code.censoring<a class="anchor" aria-label="anchor" href="#arg-code-censoring"></a></dt>
<dd><p>Integer code of censoring (default <code>0</code>).</p></dd>


<dt id="arg-code-exposure-ref">code.exposure.ref<a class="anchor" aria-label="anchor" href="#arg-code-exposure-ref"></a></dt>
<dd><p>Integer code identifying the reference exposure
category (default <code>0</code>).</p></dd>


<dt id="arg-effect-measure-">effect.measure1<a class="anchor" aria-label="anchor" href="#arg-effect-measure-"></a></dt>
<dd><p>Character string specifying the effect measure for the
primary event. Supported values are <code>"RR"</code>, <code>"OR"</code> and
<code>"SHR"</code>.</p></dd>


<dt id="arg-effect-measure-">effect.measure2<a class="anchor" aria-label="anchor" href="#arg-effect-measure-"></a></dt>
<dd><p>Character string specifying the effect measure for the
competing event. Supported values are <code>"RR"</code>, <code>"OR"</code> and
<code>"SHR"</code>.</p></dd>


<dt id="arg-time-point">time.point<a class="anchor" aria-label="anchor" href="#arg-time-point"></a></dt>
<dd><p>Numeric time point at which the exposure effect is evaluated for
time-point models. Required for <code>"competing-risk"</code> and <code>"survival"</code>
outcomes.</p></dd>


<dt id="arg-outcome-type">outcome.type<a class="anchor" aria-label="anchor" href="#arg-outcome-type"></a></dt>
<dd><p>Character string selecting the outcome type. Valid values are
<code>"competing-risk"</code>, <code>"survival"</code>, <code>"binomial"</code>, <code>"proportional-survival"</code>,
and <code>"proportional-competing-risk"</code>. The default is <code>"competing-risk"</code>.
If explicitly set to <code>NULL</code>, <code>polyreg()</code> attempts to infer the outcome type from the data: if the
event variable has more than two distinct levels, <code>"competing-risk"</code>
is assumed; otherwise, <code>"survival"</code> is assumed. Abbreviations such as
<code>"S"</code> or <code>"C"</code> are accepted; mixed or ambiguous inputs trigger
automatic detection from the event coding in <code>data</code>.</p></dd>


<dt id="arg-conf-int">conf.int<a class="anchor" aria-label="anchor" href="#arg-conf-int"></a></dt>
<dd><p>Numeric two-sided level of CIs (default <code>0.95</code>).</p></dd>


<dt id="arg-report-nuisance-parameter">report.nuisance.parameter<a class="anchor" aria-label="anchor" href="#arg-report-nuisance-parameter"></a></dt>
<dd><p>Logical; if <code>TRUE</code>, the returned object
includes estimates of the nuisance model parameters (default <code>FALSE</code>).</p></dd>


<dt id="arg-report-optim-convergence">report.optim.convergence<a class="anchor" aria-label="anchor" href="#arg-report-optim-convergence"></a></dt>
<dd><p>Logical; if <code>TRUE</code>, optimization
convergence summaries are returned (default <code>FALSE</code>).</p></dd>


<dt id="arg-report-sandwich-conf">report.sandwich.conf<a class="anchor" aria-label="anchor" href="#arg-report-sandwich-conf"></a></dt>
<dd><p>Logical or <code>NULL</code>. When <code>TRUE</code>,
confidence intervals based on sandwich variance are computed.
When <code>FALSE</code>, they are omitted (default <code>TRUE</code>).
This confidence interval is default for time-point models
(<code>"outcome.type=competing-risk"</code>, <code>"survival"</code> or <code>"binomial"</code>) and
is not available otherwise.</p></dd>


<dt id="arg-report-boot-conf">report.boot.conf<a class="anchor" aria-label="anchor" href="#arg-report-boot-conf"></a></dt>
<dd><p>Logical or <code>NULL</code>. When <code>TRUE</code>, bootstrap
confidence intervals are computed. When <code>FALSE</code>, they are omitted.
If <code>NULL</code>, the function chooses based on <code>outcome.type</code> (default <code>NULL</code>).
This confidence interval is default for proportional models
(<code>outcome.type="proportional-competing-risk"</code> or <code>"proportional-survival"</code>).</p></dd>


<dt id="arg-boot-bca">boot.bca<a class="anchor" aria-label="anchor" href="#arg-boot-bca"></a></dt>
<dd><p>Logical indicating the bootstrap confidence interval method.
Use <code>TRUE</code> for bias-corrected and accelerated intervals or <code>FALSE</code>
for the normal approximation (default <code>FALSE</code>).</p></dd>


<dt id="arg-boot-multiplier">boot.multiplier<a class="anchor" aria-label="anchor" href="#arg-boot-multiplier"></a></dt>
<dd><p>Character string specifying the wild bootstrap weight distribution.
One of <code>"rademacher"</code>, <code>"mammen"</code> or <code>"gaussian"</code> (default <code>"rademacher"</code>).</p></dd>


<dt id="arg-boot-replications">boot.replications<a class="anchor" aria-label="anchor" href="#arg-boot-replications"></a></dt>
<dd><p>Integer giving the number of bootstrap replications
(default <code>200</code>).</p></dd>


<dt id="arg-boot-seed">boot.seed<a class="anchor" aria-label="anchor" href="#arg-boot-seed"></a></dt>
<dd><p>Numeric seed used for resampling of bootstrap.</p></dd>


<dt id="arg-nleqslv-method">nleqslv.method<a class="anchor" aria-label="anchor" href="#arg-nleqslv-method"></a></dt>
<dd><p>Character string specifying the solver used in
<span class="pkg">nleqslv()</span>. Available choices are <code>"Broyden"</code> and <code>"Newton"</code>.</p></dd>


<dt id="arg-optim-parameter-">optim.parameter1<a class="anchor" aria-label="anchor" href="#arg-optim-parameter-"></a></dt>
<dd><p>Numeric tolerance for convergence of the outer loop
(default <code>1e-6</code>).</p></dd>


<dt id="arg-optim-parameter-">optim.parameter2<a class="anchor" aria-label="anchor" href="#arg-optim-parameter-"></a></dt>
<dd><p>Numeric tolerance for convergence of the inner loop
(default <code>1e-6</code>).</p></dd>


<dt id="arg-optim-parameter-">optim.parameter3<a class="anchor" aria-label="anchor" href="#arg-optim-parameter-"></a></dt>
<dd><p>Numeric constraint on the absolute value of
parameters (default <code>100</code>).</p></dd>


<dt id="arg-optim-parameter-">optim.parameter4<a class="anchor" aria-label="anchor" href="#arg-optim-parameter-"></a></dt>
<dd><p>Integer maximum number of outer loop iterations
(default <code>50</code>).</p></dd>


<dt id="arg-optim-parameter-">optim.parameter5<a class="anchor" aria-label="anchor" href="#arg-optim-parameter-"></a></dt>
<dd><p>Integer maximum number of <code>nleqslv</code>
iterations per outer iteration (default <code>50</code>).</p></dd>


<dt id="arg-optim-parameter-">optim.parameter6<a class="anchor" aria-label="anchor" href="#arg-optim-parameter-"></a></dt>
<dd><p>Integer maximum number of iterations for the
Levenberg-Marquardt routine (default <code>50</code>).</p></dd>


<dt id="arg-optim-parameter-">optim.parameter7<a class="anchor" aria-label="anchor" href="#arg-optim-parameter-"></a></dt>
<dd><p>Numeric convergence tolerance for the
Levenberg-Marquardt routine (default <code>1e-10</code>).</p></dd>


<dt id="arg-optim-parameter-">optim.parameter8<a class="anchor" aria-label="anchor" href="#arg-optim-parameter-"></a></dt>
<dd><p>Numeric tolerance for updating the Hessian in the
Levenberg-Marquardt routine (default <code>1e-6</code>).</p></dd>


<dt id="arg-optim-parameter-">optim.parameter9<a class="anchor" aria-label="anchor" href="#arg-optim-parameter-"></a></dt>
<dd><p>Numeric starting value for the Levenberg-Marquardt
damping parameter lambda (default <code>1e-6</code>).</p></dd>


<dt id="arg-optim-parameter-">optim.parameter10<a class="anchor" aria-label="anchor" href="#arg-optim-parameter-"></a></dt>
<dd><p>Numeric upper bound for lambda in the
Levenberg-Marquardt routine (default <code>40</code>).</p></dd>


<dt id="arg-optim-parameter-">optim.parameter11<a class="anchor" aria-label="anchor" href="#arg-optim-parameter-"></a></dt>
<dd><p>Numeric lower bound for lambda in the
Levenberg-Marquardt routine (default <code>0.025</code>).</p></dd>


<dt id="arg-optim-parameter-">optim.parameter12<a class="anchor" aria-label="anchor" href="#arg-optim-parameter-"></a></dt>
<dd><p>Numeric multiplicative increment applied to lambda
when the Levenberg-Marquardt step is successful (default <code>2</code>).</p></dd>


<dt id="arg-optim-parameter-">optim.parameter13<a class="anchor" aria-label="anchor" href="#arg-optim-parameter-"></a></dt>
<dd><p>Numeric multiplicative decrement applied to lambda
when the Levenberg-Marquardt step is unsuccessful (default <code>0.5</code>).</p></dd>


<dt id="arg-data-initial-values">data.initial.values<a class="anchor" aria-label="anchor" href="#arg-data-initial-values"></a></dt>
<dd><p>Optional data frame providing starting values for
the optimization (default <code>NULL</code>).</p></dd>


<dt id="arg-normalize-covariate">normalize.covariate<a class="anchor" aria-label="anchor" href="#arg-normalize-covariate"></a></dt>
<dd><p>Logical indicating whether covariates should
be centered and scaled prior to optimization (default <code>TRUE</code>).</p></dd>


<dt id="arg-terminate-time-point">terminate.time.point<a class="anchor" aria-label="anchor" href="#arg-terminate-time-point"></a></dt>
<dd><p>Logical indicating whether time points
that contribute estimation are terminated by min of max follow-up times
of each exposure level (default <code>TRUE</code>).</p></dd>


<dt id="arg-prob-bound">prob.bound<a class="anchor" aria-label="anchor" href="#arg-prob-bound"></a></dt>
<dd><p>Numeric lower bound used to internally truncate probabilities away
from 0 and 1 (default <code>1e-5</code>).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list of class <code>"polyreg"</code> containing the fitted exposure effects and
supporting results. Key components and methods include:</p><ul><li><p><code>coef</code>: regression coefficients on the chosen effect-measure scale</p></li>
<li><p><code>vcov</code>: variance–covariance matrix of the regression coefficients</p></li>
<li><p><code>diagnostic.statistics</code>: a data frame with inverse probability weights,
influence function contributions, and predicted potential outcomes</p></li>
<li><p><code>summary</code>: event-wise tidy/glance summaries used by
<code><a href="polyreg-methods.html">summary.polyreg()</a></code> or <code><a href="https://modelsummary.com/man/modelsummary.html" class="external-link">modelsummary::modelsummary()</a></code></p></li>
<li><p>additional elements storing convergence information and internal
tuning parameters.</p></li>
</ul><p>Standard S3 methods are available: <code><a href="polyreg-methods.html">coef.polyreg()</a></code>, <code><a href="polyreg-methods.html">vcov.polyreg()</a></code>,
<code><a href="polyreg-methods.html">nobs.polyreg()</a></code>, and <code><a href="polyreg-methods.html">summary.polyreg()</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>

<div class="section">
<h3 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a></h3>


<p><code>polyreg()</code> implements <strong>log odds product modeling</strong> for CIFs at user-specified
time points, focusing on multiplicative effects of a categorical exposure, or
constant effects over time like Cox regression and Fine-Gray models. It estimates
multiplicative effects such as <strong>risk ratios</strong>, <strong>odds ratios</strong>, or
<strong>subdistribution hazard ratios</strong>, while ensuring that the probabilities across
competing events sum to one. This is achieved through
<strong>reparameterization using polytomous log odds products</strong>, which fits so-called
effect-measure models and nuisance models on multiple competing events
simultaneously. Additionally, <code>polyreg()</code> supports direct binomial regression
for survival outcomes and the Richardson model for binomial outcomes,
both of which use log odds products.</p>
</div>

<div class="section">
<h3 id="key-arguments">Key arguments<a class="anchor" aria-label="anchor" href="#key-arguments"></a></h3>

<ul><li><p><code>nuisance.model</code>: a formula with <code><a href="Event.html">Event()</a></code> or <code>survivai::Surv()</code>
describing the outcome and nuisance covariates, excluding the exposure of interest.</p></li>
<li><p><code>exposure</code>: name of the categorical exposure variable</p></li>
<li><p><code>effect.measure1</code> and <code>effect.measure2</code>: the effect measures
for event1 and event2 (<code>"RR"</code>, <code>"OR"</code> or <code>"SHR"</code>).</p></li>
<li><p><code>outcome.type</code>: type of the outcome variable (<code>"competing-risk"</code>, <code>"survival"</code>,
<code>"binomial"</code>, <code>"proportional-survival"</code> or <code>"proportional-competing-risk"</code>).</p></li>
<li><p><code>time.point</code>: time point(s) at which the exposure effect is evaluated.
Required for <code>"competing-risk"</code> and <code>"survival"</code> outcomes.</p></li>
<li><p><code>strata</code>: name of the stratification variable used for IPCW adjustment for dependent censoring.</p></li>
</ul></div>

<div class="section">
<h3 id="outcome-type-and-event-status-coding">Outcome type and event status coding<a class="anchor" aria-label="anchor" href="#outcome-type-and-event-status-coding"></a></h3>


<p>The <code>outcome.type</code> argument must be set to:</p><ul><li><p>Effects on cumulative incidence probabilities at a specific time:
<code>"competing-risk"</code>.</p></li>
<li><p>Effects on a risk at a specific time: <code>"survival"</code>.</p></li>
<li><p>Common effects on cumulative incidence probabilities over time:
<code>"proportional-competing-risk"</code>.</p></li>
<li><p>Common effects on a risk over time: <code>"proportional-survival"</code>.</p></li>
<li><p>Effects on a risk of a binomial outcome: <code>"binomial"</code>.</p></li>
</ul><table class="table table"><tr><td>Setting</td><td>Codes</td><td>Meaning</td></tr><tr><td>competing-risk</td><td><code>code.event1</code>, <code>code.event2</code>, <code>code.censoring</code></td><td>event of interest / competing event / censoring</td></tr><tr><td>competing-risk (default)</td><td><code>code.event1 = 1</code>, <code>code.event2 = 2</code>, <code>code.censoring = 0</code></td><td>event of interest / competing event / censoring</td></tr><tr><td>survival</td><td><code>code.event1</code>, <code>code.censoring</code></td><td>event / censoring</td></tr><tr><td>survival (default)</td><td><code>code.event1 = 1</code>, <code>code.censoring = 0</code></td><td>event / censoring</td></tr><tr><td>survival (ADaM-ADTTE)</td><td><code>code.event1 = 0</code>, <code>code.censoring = 1</code></td><td>set to match ADaM convention</td></tr><tr><td>proportional-survival</td><td><code>code.event1</code>, <code>code.censoring</code></td><td>event / censoring</td></tr><tr><td>proportional-survival (default)</td><td><code>code.event1 = 1</code>, <code>code.censoring = 0</code></td><td>event / censoring</td></tr><tr><td>proportional-survival (ADaM)</td><td><code>code.event1 = 0</code>, <code>code.censoring = 1</code></td><td>set to match ADaM convention</td></tr><tr><td>proportional-competing-risk</td><td><code>code.event1</code>, <code>code.event2</code>, <code>code.censoring</code></td><td>event of interest / competing event / censoring</td></tr><tr><td>proportional-competing-risk (default)</td><td><code>code.event1 = 1</code>, <code>code.event2 = 2</code>, <code>code.censoring = 0</code></td><td>event of interest / competing event / censoring</td></tr></table></div>

<div class="section">
<h3 id="effect-measures-for-categorical-exposure">Effect measures for categorical exposure<a class="anchor" aria-label="anchor" href="#effect-measures-for-categorical-exposure"></a></h3>


<p>Choose the effect scale for event 1 and (optionally) event 2:</p><table class="table table"><tr><td>Argument</td><td>Applies to</td><td>Choices</td><td>Default</td></tr><tr><td><code>effect.measure1</code></td><td>event of interest</td><td><code>"RR"</code>, <code>"OR"</code>, <code>"SHR"</code></td><td><code>"RR"</code></td></tr><tr><td><code>effect.measure2</code></td><td>competing event</td><td><code>"RR"</code>, <code>"OR"</code>, <code>"SHR"</code></td><td><code>"RR"</code></td></tr></table><ul><li><p><code>RR</code>: risk ratio at <code>time.point</code> or common over time.</p></li>
<li><p><code>OR</code>: odds ratio at <code>time.point</code> or common over time.</p></li>
<li><p><code>SHR</code>: subdistribution hazard ratio or common over time.</p></li>
</ul></div>

<div class="section">
<h3 id="inference-and-intervals-advanced-">Inference and intervals (advanced)<a class="anchor" aria-label="anchor" href="#inference-and-intervals-advanced-"></a></h3>
<table class="table table"><tr><td>Argument</td><td>Meaning</td><td>Default</td></tr><tr><td><code>conf.int</code></td><td>Wald-type CI level</td><td><code>0.95</code></td></tr><tr><td><code>report.sandwich.conf</code></td><td>Sandwich variance CIs</td><td><code>TRUE</code></td></tr><tr><td><code>report.boot.conf</code></td><td>Bootstrap CIs (used by <code>"proportional-*"</code> types)</td><td><code>NULL</code></td></tr><tr><td><code>boot.bca</code></td><td>Use BCa intervals (else normal approximation)</td><td><code>FALSE</code></td></tr><tr><td><code>boot.multiplier</code></td><td>Method for wild bootstrap</td><td><code>"rademacher"</code></td></tr><tr><td><code>boot.replications</code></td><td>Bootstrap replications</td><td><code>200</code></td></tr><tr><td><code>boot.seed</code></td><td>Seed for resampling</td><td><code>46</code></td></tr></table></div>

<div class="section">
<h3 id="optimization-amp-solver-controls-advanced-">Optimization &amp; solver controls (advanced)<a class="anchor" aria-label="anchor" href="#optimization-amp-solver-controls-advanced-"></a></h3>


<p><code>polyreg()</code> solves estimating equations with optional inner routines.</p><table class="table table"><tr><td>Argument</td><td>Role</td><td>Default</td></tr><tr><td><code>nleqslv.method</code></td><td>Root solver</td><td><code>"Newton"</code></td></tr><tr><td><code>optim.parameter1</code>, <code>optim.parameter2</code></td><td>Outer / inner convergence tolerances</td><td><code>1e-6</code>, <code>1e-6</code></td></tr><tr><td><code>optim.parameter3</code></td><td>Parameter absolute bound</td><td><code>100</code></td></tr><tr><td><code>optim.parameter4</code></td><td>Max outer iterations</td><td><code>50</code></td></tr><tr><td><code>optim.parameter5</code></td><td>Max <code>nleqslv</code> iterations per outer</td><td><code>50</code></td></tr><tr><td><code>optim.parameter6:13</code></td><td>Levenberg–Marquardt controls (iterations, tolerances, lambda)</td><td>see defaults</td></tr></table></div>

<div class="section">
<h3 id="data-handling-and-stability">Data handling and stability<a class="anchor" aria-label="anchor" href="#data-handling-and-stability"></a></h3>
<table class="table table"><tr><td>Argument</td><td>Meaning</td><td>Default</td></tr><tr><td><code>subset.condition</code></td><td>Expression (as character) to subset <code>data</code></td><td><code>NULL</code></td></tr><tr><td><code>na.action</code></td><td>NA handling function</td><td><code><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">stats::na.omit</a></code></td></tr><tr><td><code>normalize.covariate</code></td><td>Center/scale nuisance covariates</td><td><code>TRUE</code></td></tr><tr><td><code>terminate.time.point</code></td><td>Truncate support by exposure-wise follow-up maxima</td><td><code>TRUE</code></td></tr><tr><td><code>prob.bound</code></td><td>Truncate probabilities away from 0/1 (numerical guard)</td><td><code>1e-5</code></td></tr><tr><td><code>data.initial.values</code></td><td>Optional starting values data frame</td><td><code>NULL</code></td></tr></table></div>

<div class="section">
<h3 id="downstream-use">Downstream use<a class="anchor" aria-label="anchor" href="#downstream-use"></a></h3>


<p><code>polyreg()</code> returns an object of class <code>"polyreg"</code> that contains
regression coefficients (<code>coef</code>), variance-covariance matrix (<code>vcov</code>)
and a list of event-wise <em>tidy</em> and <em>glance</em> tables (<code>summary</code>).
Users should typically access results via the S3 methods:</p><ul><li><p><code><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef()</a></code> — extract regression coefficients.</p></li>
<li><p><code><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov()</a></code> — extract the variance–covariance matrix
(sandwich or bootstrap, depending on <code>outcome.type</code> and the
<code>report.*</code> arguments).</p></li>
<li><p><code><a href="https://rdrr.io/r/stats/nobs.html" class="external-link">nobs()</a></code> — number of observations used in the fit.</p></li>
<li><p><code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> — print an event-wise, modelsummary-like table of estimates,
CIs and p-values, and return the underlying list of tidy/glance tables invisibly.</p></li>
</ul><p>For backward compatibility, components named <code>coefficient</code> and <code>cov</code>
may also be present and mirror <code>coef</code> and <code>vcov</code>, respectively.
The <code>summary</code> component can be passed to external functions such as
<code>modelsummary()</code> for further formatting, if desired.</p>
</div>

<div class="section">
<h3 id="reproducibility-and-conventions">Reproducibility and conventions<a class="anchor" aria-label="anchor" href="#reproducibility-and-conventions"></a></h3>

<ul><li><p>If convergence warnings appear, relax/tighten tolerances or cap the parameter
bound (<code>optim.parameter1</code>–<code>3</code>) and inspect the output with
<code>report.optim.convergence = TRUE</code>.</p></li>
<li><p>If necessary, modify other <code>optim.parameter</code>, provide user-specified
initial values, or reduce the number of nuisance parameters (e.g., provide
a small set of time points contributing to estimation when using
<code>"proportional-survival"</code> or <code>"proportional-competing-risk"</code>).</p></li>
<li><p>Set <code>boot.seed</code> for reproducible bootstrap results.</p></li>
<li><p>Match CDISC ADaM conventions via <code>code.event1 = 0</code>, <code>code.censoring = 1</code>
(and, if applicable, <code>code.event2</code> for competing events).</p></li>
</ul></div>

    </div>
    <div class="section level2">
    <h2 id="lifecycle">Lifecycle<a class="anchor" aria-label="anchor" href="#lifecycle"></a></h2>


<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental" class="external-link"><img src="figures/lifecycle-experimental.svg" alt="[Experimental]"></a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="cifcurve.html">cifcurve()</a></code> for KM/AJ estimators; <code><a href="cifplot.html">cifplot()</a></code> for display of a CIF; <code><a href="cifpanel.html">cifpanel()</a></code> for display of multiple CIFs; <a href="http://www.danieldsjoberg.com/ggsurvfit/reference/ggsurvfit.html" class="external-link">ggsurvfit::ggsurvfit</a>, <a href="https://patchwork.data-imaginist.com/reference/patchwork-package.html" class="external-link">patchwork::patchwork</a> and <a href="https://modelsummary.com/man/modelsummary.html" class="external-link">modelsummary::modelsummary</a> for display helpers.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">diabetes.complications</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">output</span> <span class="op">&lt;-</span> <span class="fu">polyreg</span><span class="op">(</span></span></span>
<span class="r-in"><span>  nuisance.model <span class="op">=</span> <span class="fu"><a href="Event.html">Event</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">epsilon</span><span class="op">)</span> <span class="op">~</span> <span class="op">+</span><span class="fl">1</span>,</span></span>
<span class="r-in"><span>  exposure <span class="op">=</span> <span class="st">"fruitq1"</span>,</span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">diabetes.complications</span>,</span></span>
<span class="r-in"><span>  effect.measure1 <span class="op">=</span> <span class="st">"RR"</span>,</span></span>
<span class="r-in"><span>  effect.measure2 <span class="op">=</span> <span class="st">"RR"</span>,</span></span>
<span class="r-in"><span>  time.point <span class="op">=</span> <span class="fl">8</span>,</span></span>
<span class="r-in"><span>  outcome.type <span class="op">=</span> <span class="st">"competing-risk"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error:</span> object 'fit' not found</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error:</span> object 'fit' not found</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/nobs.html" class="external-link">nobs</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error:</span> object 'fit' not found</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error:</span> object 'fit' not found</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Shiro Tanaka.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

