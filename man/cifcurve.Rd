% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/cifcurve.R
\name{cifcurve}
\alias{cifcurve}
\title{Calculate the Kaplan–Meier estimator and the Aalen–Johansen estimator with various SE and CI methods.}
\usage{
cifcurve(
  formula,
  data,
  weights = NULL,
  subset.condition = NULL,
  na.action = na.omit,
  outcome.type = c("SURVIVAL", "COMPETING-RISK"),
  code.event1 = 1,
  code.event2 = 2,
  code.censoring = 0,
  error = NULL,
  conf.type = "arcsine-square root",
  conf.int = 0.95,
  report.survfit.std.err = FALSE
)
}
\arguments{
\item{formula}{A model formula specifying the outcome and (optionally) \code{strata()}.}

\item{data}{A data frame containing variables in \code{formula}.}

\item{weights}{Optional name of the weight variable in \code{data}. Weights must be nonnegative; strictly positive is recommended.}

\item{subset.condition}{Optional character expression to subset \code{data} before analysis.}

\item{na.action}{Function to handle missing values (default: \code{na.omit} in \pkg{stats}).}

\item{outcome.type}{Character string specifying the type of time-to-event outcome.
One of \code{"SURVIVAL"} (Kaplan–Meier type) or \code{"COMPETING-RISK"} (Aalen–Johansen type).
If \code{NULL} (default), the function automatically infers the outcome type
from the data: if the event variable has more than two unique levels,
\code{"COMPETING-RISK"} is assumed; otherwise, \code{"SURVIVAL"} is used.
You can also use abbreviations such as \code{"S"} or \code{"C"}.
Mixed or ambiguous inputs (e.g., \code{c("S", "C")}) trigger automatic
detection based on the event coding in \code{data}.}

\item{code.event1}{Integer code of the event of interest (default \code{1}).}

\item{code.event2}{Integer code of the competing event (default \code{2}).}

\item{code.censoring}{Integer code of censoring (default \code{0}).}

\item{error}{Character specifying variance type used internally. For \code{"SURVIVAL"} typically \code{"greenwood"}.
For \code{"COMPETING-RISK"} pass options supported by \code{calculateAalenDeltaSE()} (\code{"aalen"}, \code{"delta"}, \code{"none"}).}

\item{conf.type}{Character transformation for CI on the probability scale (default \code{"arcsine-square root"}).}

\item{conf.int}{numeric two-sided confidence level (default \code{0.95}).}

\item{report.survfit.std.err}{If \code{TRUE}, report SE on the log-survival scale (survfit's convention). Otherwise SE is on the probability scale.}
}
\value{
A \code{survfit} object. For \code{outcome.type="SURVIVAL"}, \code{$surv} is the survival function.
For \code{outcome.type="COMPETING-RISK"}, \code{$surv} equals \code{1 - CIF} for \code{code.event1}.
Standard error and CIs are provided per \code{conf.type}. Note that some methods for \code{survfit} (e.g., \code{residuals.survfit}) may not be supported.
}
\description{
Estimate and plot survival curves using the Kaplan–Meier estimator or
cumulative incidence curves under competing risks using the Aalen–Johansen estimator.
Returns a \code{survfit}-compatible object and, by default, draws a publication-ready plot via \pkg{ggsurvfit}.
}
\details{
\strong{Estimation:}
\itemize{
\item \code{outcome.type = "SURVIVAL"}: Kaplan–Meier estimator with Greenwood-type variance.
\item \code{outcome.type = "COMPETING-RISK"}: Aalen–Johansen estimator for CIF of \code{code.event1}
using IPCW for the censoring distribution. The returned \code{surv} corresponds to \code{1 - CIF}.
}
\strong{Confidence intervals:}
Constructed on the probability scale with the specified \code{conf.type}.
If \code{conf.type \%in\% c("none","n")}, the plot suppresses CI bands.
}
\examples{
data(diabetes.complications)
out_cifcurve <- cifcurve(Event(t,epsilon) ~ fruitq,
                         data = diabetes.complications,
                         outcome.type='COMPETING-RISK')
cifplot(out_cifcurve,
        type.y = 'risk',
        addRiskTable = FALSE,
        label.y = 'CIF of diabetic retinopathy',
        label.x = 'Years from registration')

}
\seealso{
\code{\link[=polyreg]{polyreg()}} for log-odds product modeling of CIFs; \code{\link[=cifplot]{cifplot()}} for display of a CIF; \code{\link[=cifpanel]{cifpanel()}} for display of multiple CIFs; \link[ggsurvfit:ggsurvfit]{ggsurvfit::ggsurvfit}, \link[patchwork:patchwork-package]{patchwork::patchwork} and \link[modelsummary:modelsummary]{modelsummary::modelsummary} for display helpers.
}
